/*! surface.js
 * This is a JavaScript implementation of the EDTSurf algorithm.
 * It was developed by Takanori Nakane and revised by Hongjian Li.
 * http://github.com/HongjianLi/istar
 * Copyright (c) 2012-2014 Chinese University of Hong Kong
 * License: Apache License 2.0
 * Hongjian Li, Kwong-Sak Leung, Takanori Nakane and Man-Hon Wong.
 * iview: an interactive WebGL visualizer for protein-ligand complex.
 * BMC Bioinformatics, 15(1):56, 2014.
 *
 * EDTSurf
 * http://zhanglab.ccmb.med.umich.edu/EDTSurf
 * Dong Xu and Yang Zhang. Generating Triangulated Macromolecular Surfaces
 * by Euclidean Distance Transform. PLoS ONE, 4(12):e8140, 2009.
 * Dong Xu, Hua Li and Yang Zhang. Protein Depth Calculation and the Use
 * for Improving Accuracy of Protein Fold Recognition.
 * Journal of Computational Biology, 20(10):805-816, 2013.
 */
var ProteinSurface=function(F){var y,x,w;var D=128;var b=1.4,c=1;var l,s,A;var d;var u;var p,z;var n,m,g,h,f,e;var C=[1.9,1.88,1.63,1.48,1.78,1.2,1.87,1.96,1.63,0.74,1.8,1.48,1.2];var q=new Array(13),r=new Array(13);var B=2;var a,E;var o=[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1],[1,1,0],[1,-1,0],[-1,1,0],[-1,-1,0],[1,0,1],[1,0,-1],[-1,0,1],[-1,0,-1],[0,1,1],[0,1,-1],[0,-1,1],[0,-1,-1],[1,1,1],[1,1,-1],[1,-1,1],[-1,1,1],[1,-1,-1],[-1,-1,1],[-1,1,-1],[-1,-1,-1]];var v=function(G,I,H){this.x=G;this.y=I;this.z=H};var t=function(H,G,I){this.a=H;this.b=G;this.c=I};this.initparm=function(J,H,K){var I=2.5;n=J.x,h=H.x;m=J.y,f=H.y;g=J.z,e=H.z;if(K){n-=I;m-=I;g-=I;h+=I;f+=I;e+=I}else{n-=b+I;m-=b+I;g-=b+I;h+=b+I;f+=b+I;e+=b+I}y=-n;x=-m;w=-g;c=h-n;if((f-m)>c){c=f-m}if((e-g)>c){c=e-g}c=(D-1)/c;D=Math.floor(D*B/c);c=B;var G=180;if(D>G){sfthresh=G/D;D=Math.floor(G);c=c*sfthresh}A=Math.ceil(c*(h-n))+1;s=Math.ceil(c*(f-m))+1;l=Math.ceil(c*(e-g))+1;if(A>D){A=D}if(s>D){s=D}if(l>D){l=D}this.boundingatom(K);cutRadis=b*c;u=new Array(A*s*l)};this.boundingatom=function(M){var L=new Array(13);var J,H,K,G;for(var I=0;I<13;++I){if(!M){L[I]=C[I]*c+0.5}else{L[I]=(C[I]+b)*c+0.5}K=L[I]*L[I];r[I]=Math.floor(L[I])+1;q[I]=new Array(r[I]*r[I]);indx=0;for(j=0;j<r[I];++j){for(k=0;k<r[I];++k){J=j*j+k*k;if(J>K){q[I][indx]=-1}else{H=Math.sqrt(K-J);q[I][indx]=Math.floor(H)}indx++}}}};this.fillvoxels=function(G){for(var H=0,I=u.length;H<I;++H){u[H]={inout:false,isdone:false,isbound:false,distance:-1,atomid:-1}}for(H in G){this.fillAtom(G[H],G)}for(H=0,I=u.length;H<I;++H){if(u[H].inout){u[H].isdone=true}}this.vp=u;for(var H=0,I=u.length;H<I;++H){if(u[H].inout){u[H].isdone=true}}};this.fillAtom=function(S,R){var P,N,M,J,I,H;P=Math.floor(0.5+c*(S.coord.x+y));N=Math.floor(0.5+c*(S.coord.y+x));M=Math.floor(0.5+c*(S.coord.z+w));var L=this.getAtomType(S);var Q=0;var K=0;for(i=0;i<r[L];++i){for(j=0;j<r[L];++j){if(q[L][Q]!=-1){for(ii=-1;ii<2;++ii){for(jj=-1;jj<2;++jj){for(kk=-1;kk<2;++kk){if(ii!=0&&jj!=0&&kk!=0){mi=ii*i;mk=kk*j;for(k=0;k<=q[L][Q];++k){mj=k*jj;si=P+mi;sj=N+mj;sk=M+mk;if(si<0||sj<0||sk<0||si>=A||sj>=s||sk>=l){continue}var G=u[si*s*l+sj*l+sk];if(false){G.inout=true}else{if(G.inout==false){G.inout=true;G.atomid=S.serial}else{if(G.inout){var O=R[G.atomid];J=Math.floor(0.5+c*(O.coord.x+y));I=Math.floor(0.5+c*(O.coord.y+x));H=Math.floor(0.5+c*(O.coord.z+w));if(mi*mi+mj*mj+mk*mk<J*J+I*I+H*H){G.atomid=S.serial}}}}}}}}}}Q++}}};this.fillvoxelswaals=function(G){for(var H=0,I=u.length;H<I;++H){u[H].isdone=false}for(H in G){this.fillAtomWaals(G[H],G)}};this.fillAtomWaals=function(R,Q){var O,M,L,J,I,H,P=0;O=Math.floor(0.5+c*(R.coord.x+y));M=Math.floor(0.5+c*(R.coord.y+x));L=Math.floor(0.5+c*(R.coord.z+w));var K=this.getAtomType(R);for(i=0;i<r[K];++i){for(j=0;j<r[K];++j){if(q[K][P]!=-1){for(ii=-1;ii<2;++ii){for(jj=-1;jj<2;++jj){for(kk=-1;kk<2;++kk){if(ii!=0&&jj!=0&&kk!=0){mi=ii*i;mk=kk*j;for(k=0;k<=q[K][P];++k){mj=k*jj;si=O+mi;sj=M+mj;sk=L+mk;if(si<0||sj<0||sk<0){continue}var G=u[si*s*l+sj*l+sk];if(false){G.isdone=true;continue}else{if(G!=undefined&&G.isdone==false){G.isdone=true;G.atomid=R.serial}else{if(G!=undefined&&G.isdone){var N=Q[G.atomid];J=Math.floor(0.5+c*(N.coord.x+y));I=Math.floor(0.5+c*(N.coord.y+x));H=Math.floor(0.5+c*(N.coord.z+w));if(mi*mi+mj*mj+mk*mk<J*J+I*I+H*H){G.atomid=R.serial}}}}}}}}}}P++}}};this.getAtomType=function(H){var G=10;if(H.name=="CA"){G=0}else{if(H.name=="C"){G=1}else{if(H.elem=="C"){G=7}else{if(H.name=="0"){G=3}else{if(H.elem=="O"){G=11}else{if(H.name=="N"){G=2}else{if(H.elem=="N"){G=8}else{if(H.elem=="S"){G=4}else{if(H.elem=="P"){G=6}else{if(H.name=="FE"){G=9}else{if(H.name=="H"){G=5}else{if(H.elem=="H"){G=12}}}}}}}}}}}}return G};this.buildboundary=function(){u=this.vp;for(i=0;i<A;++i){for(j=0;j<l;++j){for(k=0;k<s;++k){var L=u[i*s*l+k*l+j];if(L.inout){var G=false;var K=0;while(!G&&K<26){var J=i+o[K][0],I=j+o[K][2],H=k+o[K][1];if(J>-1&&J<A&&H>-1&&H<s&&I>-1&&I<l&&!u[J*s*l+H*l+I].inout){L.isbound=true;G=true}else{K++}}}}}}};this.fastdistancemap=function(){var H,M,G;var O;totalsurfacevox=0;totalinnervox=0;var I=new Array(A);for(var N=0;N<A;++N){var R=new Array(s);for(var L=0;L<s;++L){var Q=new Array(l);for(var J=0;J<l;++J){Q[J]={ix:0,iy:0,iz:0}}R[L]=Q}I[N]=R}for(N=0;N<A;++N){for(L=0;L<s;++L){for(J=0;J<l;++J){var K=u[N*s*l+L*l+J];K.isdone=false;if(K.inout){if(K.isbound){totalsurfacevox++;I[N][L][J].ix=N;I[N][L][J].iy=L;I[N][L][J].iz=J;K.distance=0;K.isdone=true}else{totalinnervox++}}}}}inarray=new Array();outarray=new Array();var H=0,M=0;for(N=0;N<A;++N){for(L=0;L<s;++L){for(J=0;J<l;++J){var K=u[N*s*l+L*l+J];if(K.isbound){inarray.push({ix:N,iy:L,iz:J});H++;K.isbound=false}}}}do{M=this.fastoneshell(H,I);H=0;inarray=[];for(N=0;N<M;++N){var S=u[s*l*outarray[N].ix+l*outarray[N].iy+outarray[N].iz];S.isbound=false;if(S.distance<=1.02*cutRadis){inarray.push({ix:outarray[N].ix,iy:outarray[N].iy,iz:outarray[N].iz});H++}}}while(H!=0);var P=c-0.5;if(P<0){P=0}for(N=0;N<A;++N){for(L=0;L<s;++L){for(J=0;J<l;++J){var K=u[N*s*l+L*l+J];K.isbound=false;if(K.inout){if(!K.isdone||(K.isdone&&K.distance>=cutRadis-0.5/(0.1+P))){K.isbound=true}}}}}inarray=[];outarray=[]};this.fastoneshell=function(I,G){var M=0;var N,K,H;var S,R,P;var Q;if(I==0){return 0}outarray=[];tnv={ix:-1,iy:-1,iz:-1};for(var L=0;L<I;++L){N=inarray[L].ix;K=inarray[L].iy;H=inarray[L].iz;for(var J=0;J<6;++J){tnv.ix=N+o[J][0];tnv.iy=K+o[J][1];tnv.iz=H+o[J][2];var O=u[tnv.ix*s*l+l*tnv.iy+tnv.iz];if(tnv.ix<A&&tnv.ix>-1&&tnv.iy<s&&tnv.iy>-1&&tnv.iz<l&&tnv.iz>-1&&O.inout&&!O.isdone){G[tnv.ix][tnv.iy][H+o[J][2]].ix=G[N][K][H].ix;G[tnv.ix][tnv.iy][H+o[J][2]].iy=G[N][K][H].iy;G[tnv.ix][tnv.iy][H+o[J][2]].iz=G[N][K][H].iz;S=tnv.ix-G[N][K][H].ix;R=tnv.iy-G[N][K][H].iy;P=tnv.iz-G[N][K][H].iz;var Q=S*S+R*R+P*P;O.distance=Math.sqrt(Q);O.isdone=true;O.isbound=true;outarray.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz});M++}else{if(tnv.ix<A&&tnv.ix>-1&&tnv.iy<s&&tnv.iy>-1&&tnv.iz<l&&tnv.iz>-1&&O.inout&&O.isdone){S=tnv.ix-G[N][K][H].ix;R=tnv.iy-G[N][K][H].iy;P=tnv.iz-G[N][K][H].iz;Q=S*S+R*R+P*P;Q=Math.sqrt(Q);if(Q<O.distance){G[tnv.ix][tnv.iy][tnv.iz].ix=G[N][K][H].ix;G[tnv.ix][tnv.iy][tnv.iz].iy=G[N][K][H].iy;G[tnv.ix][tnv.iy][tnv.iz].iz=G[N][K][H].iz;O.distance=Q;if(!O.isbound){O.isbound=true;outarray.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz});M++}}}}}}for(L=0;L<I;++L){N=inarray[L].ix;K=inarray[L].iy;H=inarray[L].iz;for(J=6;J<18;++J){tnv.ix=N+o[J][0];tnv.iy=K+o[J][1];tnv.iz=H+o[J][2];var O=u[tnv.ix*s*l+l*tnv.iy+tnv.iz];if(tnv.ix<A&&tnv.ix>-1&&tnv.iy<s&&tnv.iy>-1&&tnv.iz<l&&tnv.iz>-1&&O.inout&&!O.isdone){G[tnv.ix][tnv.iy][H+o[J][2]].ix=G[N][K][H].ix;G[tnv.ix][tnv.iy][H+o[J][2]].iy=G[N][K][H].iy;G[tnv.ix][tnv.iy][H+o[J][2]].iz=G[N][K][H].iz;S=tnv.ix-G[N][K][H].ix;R=tnv.iy-G[N][K][H].iy;P=tnv.iz-G[N][K][H].iz;Q=S*S+R*R+P*P;O.distance=Math.sqrt(Q);O.isdone=true;O.isbound=true;outarray.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz});M++}else{if(tnv.ix<A&&tnv.ix>-1&&tnv.iy<s&&tnv.iy>-1&&tnv.iz<l&&tnv.iz>-1&&O.inout&&O.isdone){S=tnv.ix-G[N][K][H].ix;R=tnv.iy-G[N][K][H].iy;P=tnv.iz-G[N][K][H].iz;Q=Math.sqrt(S*S+R*R+P*P);if(Q<O.distance){G[tnv.ix][tnv.iy][tnv.iz].ix=G[N][K][H].ix;G[tnv.ix][tnv.iy][tnv.iz].iy=G[N][K][H].iy;G[tnv.ix][tnv.iy][tnv.iz].iz=G[N][K][H].iz;O.distance=Q;if(!O.isbound){O.isbound=true;outarray.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz});M++}}}}}}for(L=0;L<I;++L){N=inarray[L].ix;K=inarray[L].iy;H=inarray[L].iz;for(J=18;J<26;++J){tnv.ix=N+o[J][0];tnv.iy=K+o[J][1];tnv.iz=H+o[J][2];var O=u[tnv.ix*s*l+l*tnv.iy+tnv.iz];if(tnv.ix<A&&tnv.ix>-1&&tnv.iy<s&&tnv.iy>-1&&tnv.iz<l&&tnv.iz>-1&&O.inout&&!O.isdone){G[tnv.ix][tnv.iy][H+o[J][2]].ix=G[N][K][H].ix;G[tnv.ix][tnv.iy][H+o[J][2]].iy=G[N][K][H].iy;G[tnv.ix][tnv.iy][H+o[J][2]].iz=G[N][K][H].iz;S=tnv.ix-G[N][K][H].ix;R=tnv.iy-G[N][K][H].iy;P=tnv.iz-G[N][K][H].iz;Q=S*S+R*R+P*P;O.distance=Math.sqrt(Q);O.isdone=true;O.isbound=true;outarray.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz});M++}else{if(tnv.ix<A&&tnv.ix>-1&&tnv.iy<s&&tnv.iy>-1&&tnv.iz<l&&tnv.iz>-1&&O.inout&&O.isdone){S=tnv.ix-G[N][K][H].ix;R=tnv.iy-G[N][K][H].iy;P=tnv.iz-G[N][K][H].iz;Q=Math.sqrt(S*S+R*R+P*P);if(Q<O.distance){G[tnv.ix][tnv.iy][tnv.iz].ix=G[N][K][H].ix;G[tnv.ix][tnv.iy][tnv.iz].iy=G[N][K][H].iy;G[tnv.ix][tnv.iy][tnv.iz].iz=G[N][K][H].iz;O.distance=Q;if(!O.isbound){O.isbound=true;outarray.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz});M++}}}}}}return M};this.marchingcube=function(H){for(var V=0,J=u.length;V<J;++V){if(H==1){u[V].isbound=false}else{if(H==4){u[V].isdone=false;if(u[V].isbound){u[V].isdone=true}u[V].isbound=false}else{if(H==2){if(u[V].isbound&&u[V].isdone){u[V].isbound=false}else{if(u[V].isbound&&!u[V].isdone){u[V].isdone=true}}}else{if(H==3){u[V].isbound=false}}}}}var P=new Array(A);for(var V=0;V<A;++V){var aa=new Array(s);for(var U=0;U<s;++U){var Z=new Array(l);for(var T=0;T<l;++T){Z[T]=-1}aa[U]=Z}P[V]=aa}p=0,z=0;E=new Array();a=new Array();var O,Q,W,I;var G=new Array(6);for(var V=0;V<6;++V){G[V]=new Array(3)}for(V=0;V<1;++V){for(U=0;U<s-1;++U){for(T=0;T<l-1;++T){var N=u[s*l*V+l*U+T].isdone,M=u[s*l*V+l*U+T+1].isdone,S=u[s*l*V+l*(U+1)+T].isdone,R=u[s*l*V+l*(U+1)+T+1].isdone,Y=u[s*l*(V+1)+l*U+T].isdone,X=u[s*l*(V+1)+l*U+T+1].isdone,L=u[s*l*(V+1)+l*(U+1)+T].isdone,K=u[s*l*(V+1)+l*(U+1)+T+1].isdone;if(N&&S&&R&&M){G[0][0]=V;G[0][1]=U;G[0][2]=T;G[1][0]=V;G[1][1]=U+1;G[1][2]=T;G[2][0]=V;G[2][1]=U+1;G[2][2]=T+1;G[3][0]=V;G[3][1]=U;G[3][2]=T+1;for(Q=0;Q<4;++Q){if(P[G[Q][0]][G[Q][1]][G[Q][2]]==-1){P[G[Q][0]][G[Q][1]][G[Q][2]]=p;E.push(new v(G[Q][0],G[Q][1],G[Q][2]));p++}}a.push(new t(P[G[0][0]][G[0][1]][G[0][2]],P[G[2][0]][G[2][1]][G[2][2]],P[G[1][0]][G[1][1]][G[1][2]]));z++;a.push(new t(P[G[0][0]][G[0][1]][G[0][2]],P[G[3][0]][G[3][1]][G[3][2]],P[G[2][0]][G[2][1]][G[2][2]]));z++}else{if((N&&S&&R)||(S&&R&&M)||(R&&M&&N)||(M&&N&&S)){if(N&&S&&R){G[0][0]=V;G[0][1]=U;G[0][2]=T;G[1][0]=V;G[1][1]=U+1;G[1][2]=T;G[2][0]=V;G[2][1]=U+1;G[2][2]=T+1}else{if(S&&R&&M){G[0][0]=V;G[0][1]=U+1;G[0][2]=T;G[1][0]=V;G[1][1]=U+1;G[1][2]=T+1;G[2][0]=V;G[2][1]=U;G[2][2]=T+1}else{if(R&&M&&N){G[0][0]=V;G[0][1]=U+1;G[0][2]=T+1;G[1][0]=V;G[1][1]=U;G[1][2]=T+1;G[2][0]=V;G[2][1]=U;G[2][2]=T}else{if(M&&N&&S){G[0][0]=V;G[0][1]=U;G[0][2]=T+1;G[1][0]=V;G[1][1]=U;G[1][2]=T;G[2][0]=V;G[2][1]=U+1;G[2][2]=T}}}}for(Q=0;Q<3;++Q){if(P[G[Q][0]][G[Q][1]][G[Q][2]]==-1){P[G[Q][0]][G[Q][1]][G[Q][2]]=p;E.push(new v(G[Q][0],G[Q][1],G[Q][2]));p++}}a.push(new t(P[G[0][0]][G[0][1]][G[0][2]],P[G[2][0]][G[2][1]][G[2][2]],P[G[1][0]][G[1][1]][G[1][2]]));z++}}}}}for(V=0;V<A-1;++V){for(U=0;U<1;++U){for(T=0;T<l-1;++T){var N=u[s*l*V+l*U+T].isdone,M=u[s*l*V+l*U+T+1].isdone,Y=u[s*l*(V+1)+l*U+T].isdone,X=u[s*l*(V+1)+l*U+T+1].isdone;if(N&&Y&&X&&M){G[0][0]=V;G[0][1]=U;G[0][2]=T;G[1][0]=V+1;G[1][1]=U;G[1][2]=T;G[2][0]=V+1;G[2][1]=U;G[2][2]=T+1;G[3][0]=V;G[3][1]=U;G[3][2]=T+1;for(Q=0;Q<4;++Q){if(P[G[Q][0]][G[Q][1]][G[Q][2]]==-1){P[G[Q][0]][G[Q][1]][G[Q][2]]=p;E.push(new v(G[Q][0],G[Q][1],G[Q][2]));p++}}a.push(new t(P[G[0][0]][G[0][1]][G[0][2]],P[G[1][0]][G[1][1]][G[1][2]],P[G[2][0]][G[2][1]][G[2][2]]));z++;a.push(new t(P[G[0][0]][G[0][1]][G[0][2]],P[G[2][0]][G[2][1]][G[2][2]],P[G[3][0]][G[3][1]][G[3][2]]));z++}else{if((N&&Y&&X)||(Y&&X&&M)||(X&&M&&N)||(M&&N&&Y)){if(N&&Y&&X){G[0][0]=V;G[0][1]=U;G[0][2]=T;G[1][0]=V+1;G[1][1]=U;G[1][2]=T;G[2][0]=V+1;G[2][1]=U;G[2][2]=T+1}else{if(Y&&X&&M){G[0][0]=V+1;G[0][1]=U;G[0][2]=T;G[1][0]=V+1;G[1][1]=U;G[1][2]=T+1;G[2][0]=V;G[2][1]=U;G[2][2]=T+1}else{if(X&&M&&N){G[0][0]=V+1;G[0][1]=U;G[0][2]=T+1;G[1][0]=V;G[1][1]=U;G[1][2]=T+1;G[2][0]=V;G[2][1]=U;G[2][2]=T}else{if(M&&N&&Y){G[0][0]=V;G[0][1]=U;G[0][2]=T+1;G[1][0]=V;G[1][1]=U;G[1][2]=T;G[2][0]=V+1;G[2][1]=U;G[2][2]=T}}}}for(Q=0;Q<3;++Q){if(P[G[Q][0]][G[Q][1]][G[Q][2]]==-1){P[G[Q][0]][G[Q][1]][G[Q][2]]=p;E.push(new v(G[Q][0],G[Q][1],G[Q][2]));p++}}a.push(new t(P[G[0][0]][G[0][1]][G[0][2]],P[G[1][0]][G[1][1]][G[1][2]],P[G[2][0]][G[2][1]][G[2][2]]));z++}}}}}for(V=0;V<A-1;++V){for(U=0;U<s-1;++U){for(T=0;T<1;++T){var N=u[s*l*V+l*U+T].isdone,S=u[s*l*V+l*(U+1)+T].isdone,Y=u[s*l*(V+1)+l*U+T].isdone,L=u[s*l*(V+1)+l*(U+1)+T].isdone;if(N&&Y&&L&&S){G[0][0]=V;G[0][1]=U;G[0][2]=T;G[1][0]=V+1;G[1][1]=U;G[1][2]=T;G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T;G[3][0]=V;G[3][1]=U+1;G[3][2]=T;for(Q=0;Q<4;++Q){if(P[G[Q][0]][G[Q][1]][G[Q][2]]==-1){P[G[Q][0]][G[Q][1]][G[Q][2]]=p;E.push(new v(G[Q][0],G[Q][1],G[Q][2]));p++}}a.push(new t(P[G[0][0]][G[0][1]][G[0][2]],P[G[2][0]][G[2][1]][G[2][2]],P[G[1][0]][G[1][1]][G[1][2]]));z++;a.push(new t(P[G[0][0]][G[0][1]][G[0][2]],P[G[3][0]][G[3][1]][G[3][2]],P[G[2][0]][G[2][1]][G[2][2]]));z++}else{if((N&&Y&&L)||(Y&&L&&S)||(L&&S&&N)||(S&&N&&Y)){if(N&&Y&&L){G[0][0]=V;G[0][1]=U;G[0][2]=T;G[1][0]=V+1;G[1][1]=U;G[1][2]=T;G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T}else{if(Y&&L&&S){G[0][0]=V+1;G[0][1]=U;G[0][2]=T;G[1][0]=V+1;G[1][1]=U+1;G[1][2]=T;G[2][0]=V;G[2][1]=U+1;G[2][2]=T}else{if(L&&S&&N){G[0][0]=V+1;G[0][1]=U+1;G[0][2]=T;G[1][0]=V;G[1][1]=U+1;G[1][2]=T;G[2][0]=V;G[2][1]=U;G[2][2]=T}else{if(S&&N&&Y){G[0][0]=V;G[0][1]=U+1;G[0][2]=T;G[1][0]=V;G[1][1]=U;G[1][2]=T;G[2][0]=V+1;G[2][1]=U;G[2][2]=T}}}}for(Q=0;Q<3;++Q){if(P[G[Q][0]][G[Q][1]][G[Q][2]]==-1){P[G[Q][0]][G[Q][1]][G[Q][2]]=p;E.push(new v(G[Q][0],G[Q][1],G[Q][2]));p++}}a.push(new t(P[G[0][0]][G[0][1]][G[0][2]],P[G[2][0]][G[2][1]][G[2][2]],P[G[1][0]][G[1][1]][G[1][2]]));z++}}}}}for(V=A-1;V<A;++V){for(U=0;U<s-1;++U){for(T=0;T<l-1;++T){var N=u[s*l*V+l*U+T].isdone,M=u[s*l*V+l*U+T+1].isdone,S=u[s*l*V+l*(U+1)+T].isdone,R=u[s*l*V+l*(U+1)+T+1].isdone;if(N&&S&&R&&M){G[0][0]=V;G[0][1]=U;G[0][2]=T;G[1][0]=V;G[1][1]=U+1;G[1][2]=T;G[2][0]=V;G[2][1]=U+1;G[2][2]=T+1;G[3][0]=V;G[3][1]=U;G[3][2]=T+1;for(Q=0;Q<4;++Q){if(P[G[Q][0]][G[Q][1]][G[Q][2]]==-1){P[G[Q][0]][G[Q][1]][G[Q][2]]=p;E.push(new v(G[Q][0],G[Q][1],G[Q][2]));p++}}a.push(new t(P[G[0][0]][G[0][1]][G[0][2]],P[G[1][0]][G[1][1]][G[1][2]],P[G[2][0]][G[2][1]][G[2][2]]));z++;a.push(new t(P[G[0][0]][G[0][1]][G[0][2]],P[G[2][0]][G[2][1]][G[2][2]],P[G[3][0]][G[3][1]][G[3][2]]));z++}else{if((N&&S&&R)||(S&&R&&M)||(R&&M&&N)||(M&&N&&S)){if(N&&S&&R){G[0][0]=V;G[0][1]=U;G[0][2]=T;G[1][0]=V;G[1][1]=U+1;G[1][2]=T;G[2][0]=V;G[2][1]=U+1;G[2][2]=T+1}else{if(S&&R&&M){G[0][0]=V;G[0][1]=U+1;G[0][2]=T;G[1][0]=V;G[1][1]=U+1;G[1][2]=T+1;G[2][0]=V;G[2][1]=U;G[2][2]=T+1}else{if(R&&M&&N){G[0][0]=V;G[0][1]=U+1;G[0][2]=T+1;G[1][0]=V;G[1][1]=U;G[1][2]=T+1;G[2][0]=V;G[2][1]=U;G[2][2]=T}else{if(M&&N&&S){G[0][0]=V;G[0][1]=U;G[0][2]=T+1;G[1][0]=V;G[1][1]=U;G[1][2]=T;G[2][0]=V;G[2][1]=U+1;G[2][2]=T}}}}for(Q=0;Q<3;++Q){if(P[G[Q][0]][G[Q][1]][G[Q][2]]==-1){P[G[Q][0]][G[Q][1]][G[Q][2]]=p;E.push(new v(G[Q][0],G[Q][1],G[Q][2]));p++}}a.push(new t(P[G[0][0]][G[0][1]][G[0][2]],P[G[1][0]][G[1][1]][G[1][2]],P[G[2][0]][G[2][1]][G[2][2]]));z++}}}}}for(V=0;V<A-1;++V){for(U=s-1;U<s;++U){for(T=0;T<l-1;++T){var N=u[s*l*V+l*U+T].isdone,M=u[s*l*V+l*U+T+1].isdone,Y=u[s*l*(V+1)+l*U+T].isdone,X=u[s*l*(V+1)+l*U+T+1].isdone;if(N&&Y&&X&&M){G[0][0]=V;G[0][1]=U;G[0][2]=T;G[1][0]=V+1;G[1][1]=U;G[1][2]=T;G[2][0]=V+1;G[2][1]=U;G[2][2]=T+1;G[3][0]=V;G[3][1]=U;G[3][2]=T+1;for(Q=0;Q<4;++Q){if(P[G[Q][0]][G[Q][1]][G[Q][2]]==-1){P[G[Q][0]][G[Q][1]][G[Q][2]]=p;E.push(new v(G[Q][0],G[Q][1],G[Q][2]));p++}}a.push(new t(P[G[0][0]][G[0][1]][G[0][2]],P[G[2][0]][G[2][1]][G[2][2]],P[G[1][0]][G[1][1]][G[1][2]]));z++;a.push(new t(P[G[0][0]][G[0][1]][G[0][2]],P[G[3][0]][G[3][1]][G[3][2]],P[G[2][0]][G[2][1]][G[2][2]]));z++}else{if((N&&Y&&X)||(Y&&X&&M)||(X&&M&&N)||(M&&N&&Y)){if(N&&Y&&X){G[0][0]=V;G[0][1]=U;G[0][2]=T;G[1][0]=V+1;G[1][1]=U;G[1][2]=T;G[2][0]=V+1;G[2][1]=U;G[2][2]=T+1}else{if(Y&&X&&M){G[0][0]=V+1;G[0][1]=U;G[0][2]=T;G[1][0]=V+1;G[1][1]=U;G[1][2]=T+1;G[2][0]=V;G[2][1]=U;G[2][2]=T+1}else{if(X&&M&&N){G[0][0]=V+1;G[0][1]=U;G[0][2]=T+1;G[1][0]=V;G[1][1]=U;G[1][2]=T+1;G[2][0]=V;G[2][1]=U;G[2][2]=T}else{if(M&&N&&Y){G[0][0]=V;G[0][1]=U;G[0][2]=T+1;G[1][0]=V;G[1][1]=U;G[1][2]=T;G[2][0]=V+1;G[2][1]=U;G[2][2]=T}}}}for(Q=0;Q<3;++Q){if(P[G[Q][0]][G[Q][1]][G[Q][2]]==-1){P[G[Q][0]][G[Q][1]][G[Q][2]]=p;E.push(new v(G[Q][0],G[Q][1],G[Q][2]));p++}}a.push(new t(P[G[0][0]][G[0][1]][G[0][2]],P[G[2][0]][G[2][1]][G[2][2]],P[G[1][0]][G[1][1]][G[1][2]]));z++}}}}}for(V=0;V<A-1;++V){for(U=0;U<s-1;++U){for(T=l-1;T<l;++T){var N=u[s*l*V+l*U+T].isdone,S=u[s*l*V+l*(U+1)+T].isdone,Y=u[s*l*(V+1)+l*U+T].isdone,L=u[s*l*(V+1)+l*(U+1)+T].isdone;if(N&&Y&&L&&S){G[0][0]=V;G[0][1]=U;G[0][2]=T;G[1][0]=V+1;G[1][1]=U;G[1][2]=T;G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T;G[3][0]=V;G[3][1]=U+1;G[3][2]=T;for(Q=0;Q<4;++Q){if(P[G[Q][0]][G[Q][1]][G[Q][2]]==-1){P[G[Q][0]][G[Q][1]][G[Q][2]]=p;E.push(new v(G[Q][0],G[Q][1],G[Q][2]));p++}}a.push(new t(P[G[0][0]][G[0][1]][G[0][2]],P[G[1][0]][G[1][1]][G[1][2]],P[G[2][0]][G[2][1]][G[2][2]]));z++;a.push(new t(P[G[0][0]][G[0][1]][G[0][2]],P[G[2][0]][G[2][1]][G[2][2]],P[G[3][0]][G[3][1]][G[3][2]]));z++}else{if((N&&Y&&L)||(Y&&L&&S)||(L&&S&&N)||(S&&N&&Y)){if(N&&Y&&L){G[0][0]=V;G[0][1]=U;G[0][2]=T;G[1][0]=V+1;G[1][1]=U;G[1][2]=T;G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T}else{if(Y&&L&&S){G[0][0]=V+1;G[0][1]=U;G[0][2]=T;G[1][0]=V+1;G[1][1]=U+1;G[1][2]=T;G[2][0]=V;G[2][1]=U+1;G[2][2]=T}else{if(L&&S&&N){G[0][0]=V+1;G[0][1]=U+1;G[0][2]=T;G[1][0]=V;G[1][1]=U+1;G[1][2]=T;G[2][0]=V;G[2][1]=U;G[2][2]=T}else{if(S&&N&&Y){G[0][0]=V;G[0][1]=U+1;G[0][2]=T;G[1][0]=V;G[1][1]=U;G[1][2]=T;G[2][0]=V+1;G[2][1]=U;G[2][2]=T}}}}for(Q=0;Q<3;++Q){if(P[G[Q][0]][G[Q][1]][G[Q][2]]==-1){P[G[Q][0]][G[Q][1]][G[Q][2]]=p;E.push(new v(G[Q][0],G[Q][1],G[Q][2]));p++}}a.push(new t(P[G[0][0]][G[0][1]][G[0][2]],P[G[1][0]][G[1][1]][G[1][2]],P[G[2][0]][G[2][1]][G[2][2]]));z++}}}}}for(V=0;V<A-1;++V){for(U=0;U<s-1;++U){for(T=0;T<l-1;++T){var N=u[s*l*V+l*U+T].isdone,M=u[s*l*V+l*U+T+1].isdone,S=u[s*l*V+l*(U+1)+T].isdone,R=u[s*l*V+l*(U+1)+T+1].isdone,Y=u[s*l*(V+1)+l*U+T].isdone,X=u[s*l*(V+1)+l*U+T+1].isdone,L=u[s*l*(V+1)+l*(U+1)+T].isdone,K=u[s*l*(V+1)+l*(U+1)+T+1].isdone;var O=0;for(Q=0;Q<2;++Q){for(W=0;W<2;++W){for(I=0;I<2;++I){if(u[s*l*(V+Q)+l*(U+W)+T+I].isdone){O++}}}}if(O==3){if((N&&Y&&L)||(N&&S&&L)||(S&&Y&&L)||(N&&S&&Y)||(M&&X&&K)||(M&&R&&K)||(R&&X&&K)||(M&&R&&X)||(N&&Y&&X)||(Y&&X&&M)||(N&&X&&M)||(N&&Y&&M)||(L&&Y&&K)||(L&&X&&K)||(Y&&X&&K)||(L&&Y&&X)||(L&&S&&R)||(S&&R&&K)||(L&&R&&K)||(L&&S&&K)||(N&&S&&M)||(N&&M&&R)||(M&&S&&R)||(N&&S&&R)){if(N&&Y&&L){G[0][0]=V;G[0][1]=U;G[0][2]=T;G[1][0]=V+1;G[1][1]=U;G[1][2]=T;G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T}else{if(N&&S&&L){G[0][0]=V+1;G[0][1]=U+1;G[0][2]=T;G[1][0]=V;G[1][1]=U+1;G[1][2]=T;G[2][0]=V;G[2][1]=U;G[2][2]=T}else{if(S&&Y&&L){G[0][0]=V+1;G[0][1]=U;G[0][2]=T;G[1][0]=V+1;G[1][1]=U+1;G[1][2]=T;G[2][0]=V;G[2][1]=U+1;G[2][2]=T}else{if(N&&S&&Y){G[0][0]=V;G[0][1]=U+1;G[0][2]=T;G[1][0]=V;G[1][1]=U;G[1][2]=T;G[2][0]=V+1;G[2][1]=U;G[2][2]=T}else{if(M&&X&&K){G[0][0]=V+1;G[0][1]=U+1;G[0][2]=T+1;G[1][0]=V+1;G[1][1]=U;G[1][2]=T+1;G[2][0]=V;G[2][1]=U;G[2][2]=T+1}else{if(M&&R&&K){G[0][0]=V;G[0][1]=U;G[0][2]=T+1;G[1][0]=V;G[1][1]=U+1;G[1][2]=T+1;G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T+1}else{if(R&&X&&K){G[0][0]=V;G[0][1]=U+1;G[0][2]=T+1;G[1][0]=V+1;G[1][1]=U+1;G[1][2]=T+1;G[2][0]=V+1;G[2][1]=U;G[2][2]=T+1}else{if(M&&R&&X){G[0][0]=V+1;G[0][1]=U;G[0][2]=T+1;G[1][0]=V;G[1][1]=U;G[1][2]=T+1;G[2][0]=V;G[2][1]=U+1;G[2][2]=T+1}else{if(N&&Y&&X){G[0][0]=V+1;G[0][1]=U;G[0][2]=T+1;G[1][0]=V+1;G[1][1]=U;G[1][2]=T;G[2][0]=V;G[2][1]=U;G[2][2]=T}else{if(Y&&X&&M){G[0][0]=V;G[0][1]=U;G[0][2]=T+1;G[1][0]=V+1;G[1][1]=U;G[1][2]=T+1;G[2][0]=V+1;G[2][1]=U;G[2][2]=T}else{if(N&&X&&M){G[0][0]=V;G[0][1]=U;G[0][2]=T;G[1][0]=V;G[1][1]=U;G[1][2]=T+1;G[2][0]=V+1;G[2][1]=U;G[2][2]=T+1}else{if(N&&Y&&M){G[0][0]=V+1;G[0][1]=U;G[0][2]=T;G[1][0]=V;G[1][1]=U;G[1][2]=T;G[2][0]=V;G[2][1]=U;G[2][2]=T+1}else{if(L&&Y&&K){G[0][0]=V+1;G[0][1]=U+1;G[0][2]=T+1;G[1][0]=V+1;G[1][1]=U+1;G[1][2]=T;G[2][0]=V+1;G[2][1]=U;G[2][2]=T}else{if(L&&X&&K){G[0][0]=V+1;G[0][1]=U;G[0][2]=T+1;G[1][0]=V+1;G[1][1]=U+1;G[1][2]=T+1;G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T}else{if(Y&&X&&K){G[0][0]=V+1;G[0][1]=U;G[0][2]=T;G[1][0]=V+1;G[1][1]=U;G[1][2]=T+1;G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T+1}else{if(L&&Y&&X){G[0][0]=V+1;G[0][1]=U+1;G[0][2]=T;G[1][0]=V+1;G[1][1]=U;G[1][2]=T;G[2][0]=V+1;G[2][1]=U;G[2][2]=T+1}else{if(L&&S&&R){G[0][0]=V;G[0][1]=U+1;G[0][2]=T+1;G[1][0]=V;G[1][1]=U+1;G[1][2]=T;G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T}else{if(S&&R&&K){G[0][0]=V+1;G[0][1]=U+1;G[0][2]=T+1;G[1][0]=V;G[1][1]=U+1;G[1][2]=T+1;G[2][0]=V;G[2][1]=U+1;G[2][2]=T}else{if(L&&R&&K){G[0][0]=V+1;G[0][1]=U+1;G[0][2]=T;G[1][0]=V+1;G[1][1]=U+1;G[1][2]=T+1;G[2][0]=V;G[2][1]=U+1;G[2][2]=T+1}else{if(L&&S&&K){G[0][0]=V;G[0][1]=U+1;G[0][2]=T;G[1][0]=V+1;G[1][1]=U+1;G[1][2]=T;G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T+1}else{if(N&&S&&M){G[0][0]=V;G[0][1]=U;G[0][2]=T+1;G[1][0]=V;G[1][1]=U;G[1][2]=T;G[2][0]=V;G[2][1]=U+1;G[2][2]=T}else{if(N&&M&&R){G[0][0]=V;G[0][1]=U+1;G[0][2]=T+1;G[1][0]=V;G[1][1]=U;G[1][2]=T+1;G[2][0]=V;G[2][1]=U;G[2][2]=T}else{if(M&&S&&R){G[0][0]=V;G[0][1]=U+1;G[0][2]=T;G[1][0]=V;G[1][1]=U+1;G[1][2]=T+1;G[2][0]=V;G[2][1]=U;G[2][2]=T+1}else{if(N&&S&&R){G[0][0]=V;G[0][1]=U;G[0][2]=T;G[1][0]=V;G[1][1]=U+1;G[1][2]=T;G[2][0]=V;G[2][1]=U+1;G[2][2]=T+1}}}}}}}}}}}}}}}}}}}}}}}}for(Q=0;Q<3;++Q){if(P[G[Q][0]][G[Q][1]][G[Q][2]]==-1){P[G[Q][0]][G[Q][1]][G[Q][2]]=p;E.push(new v(G[Q][0],G[Q][1],G[Q][2]));p++}}a.push(new t(P[G[0][0]][G[0][1]][G[0][2]],P[G[1][0]][G[1][1]][G[1][2]],P[G[2][0]][G[2][1]][G[2][2]]));z++}}else{if(O==4){if((N&&Y&&L&&S)||(M&&X&&K&&R)||(N&&Y&&X&&M)||(L&&Y&&X&&K)||(L&&S&&R&&K)||(N&&S&&M&&R)){if(N&&Y&&L&&S){G[0][0]=V;G[0][1]=U;G[0][2]=T;G[1][0]=V+1;G[1][1]=U;G[1][2]=T;G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T;G[3][0]=V;G[3][1]=U+1;G[3][2]=T}else{if(M&&X&&K&&R){G[0][0]=V;G[0][1]=U;G[0][2]=T+1;G[3][0]=V+1;G[3][1]=U;G[3][2]=T+1;G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T+1;G[1][0]=V;G[1][1]=U+1;G[1][2]=T+1}else{if(N&&Y&&X&&M){G[0][0]=V;G[0][1]=U;G[0][2]=T;G[3][0]=V+1;G[3][1]=U;G[3][2]=T;G[2][0]=V+1;G[2][1]=U;G[2][2]=T+1;G[1][0]=V;G[1][1]=U;G[1][2]=T+1}else{if(L&&Y&&X&&K){G[0][0]=V+1;G[0][1]=U;G[0][2]=T;G[3][0]=V+1;G[3][1]=U+1;G[3][2]=T;G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T+1;G[1][0]=V+1;G[1][1]=U;G[1][2]=T+1}else{if(L&&S&&R&&K){G[0][0]=V;G[0][1]=U+1;G[0][2]=T;G[1][0]=V+1;G[1][1]=U+1;G[1][2]=T;G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T+1;G[3][0]=V;G[3][1]=U+1;G[3][2]=T+1}else{if(N&&S&&M&&R){G[0][0]=V;G[0][1]=U;G[0][2]=T;G[1][0]=V;G[1][1]=U+1;G[1][2]=T;G[2][0]=V;G[2][1]=U+1;G[2][2]=T+1;G[3][0]=V;G[3][1]=U;G[3][2]=T+1}}}}}}for(Q=0;Q<4;++Q){if(P[G[Q][0]][G[Q][1]][G[Q][2]]==-1){P[G[Q][0]][G[Q][1]][G[Q][2]]=p;E.push(new v(G[Q][0],G[Q][1],G[Q][2]));p++}}a.push(new t(P[G[0][0]][G[0][1]][G[0][2]],P[G[1][0]][G[1][1]][G[1][2]],P[G[2][0]][G[2][1]][G[2][2]]));z++;a.push(new t(P[G[0][0]][G[0][1]][G[0][2]],P[G[2][0]][G[2][1]][G[2][2]],P[G[3][0]][G[3][1]][G[3][2]]));z++}else{if((N&&Y&&L&&R)||(N&&S&&L&&X)||(S&&Y&&L&&M)||(N&&S&&Y&&K)||(M&&X&&K&&S)||(M&&R&&K&&Y)||(R&&X&&K&&N)||(M&&R&&X&&L)||(N&&Y&&X&&R)||(Y&&X&&M&&S)||(N&&X&&M&&L)||(N&&Y&&M&&K)||(L&&Y&&K&&M)||(L&&X&&K&&N)||(Y&&X&&K&&S)||(L&&Y&&X&&R)||(L&&S&&R&&X)||(S&&R&&K&&Y)||(L&&R&&K&&N)||(L&&S&&K&&M)||(N&&S&&M&&K)||(N&&M&&R&&L)||(M&&S&&R&&Y)||(N&&S&&R&&X)){if(N&&Y&&L&&R){G[0][0]=V;G[0][1]=U;G[0][2]=T;G[1][0]=V+1;G[1][1]=U;G[1][2]=T;G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T}else{if(N&&S&&L&&X){G[0][0]=V+1;G[0][1]=U+1;G[0][2]=T;G[1][0]=V;G[1][1]=U+1;G[1][2]=T;G[2][0]=V;G[2][1]=U;G[2][2]=T}else{if(S&&Y&&L&&M){G[0][0]=V+1;G[0][1]=U;G[0][2]=T;G[1][0]=V+1;G[1][1]=U+1;G[1][2]=T;G[2][0]=V;G[2][1]=U+1;G[2][2]=T}else{if(N&&S&&Y&&K){G[0][0]=V;G[0][1]=U+1;G[0][2]=T;G[1][0]=V;G[1][1]=U;G[1][2]=T;G[2][0]=V+1;G[2][1]=U;G[2][2]=T}else{if(M&&X&&K&&S){G[0][0]=V+1;G[0][1]=U+1;G[0][2]=T+1;G[1][0]=V+1;G[1][1]=U;G[1][2]=T+1;G[2][0]=V;G[2][1]=U;G[2][2]=T+1}else{if(M&&R&&K&&Y){G[0][0]=V;G[0][1]=U;G[0][2]=T+1;G[1][0]=V;G[1][1]=U+1;G[1][2]=T+1;G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T+1}else{if(R&&X&&K&&N){G[0][0]=V;G[0][1]=U+1;G[0][2]=T+1;G[1][0]=V+1;G[1][1]=U+1;G[1][2]=T+1;G[2][0]=V+1;G[2][1]=U;G[2][2]=T+1}else{if(M&&R&&X&&L){G[0][0]=V+1;G[0][1]=U;G[0][2]=T+1;G[1][0]=V;G[1][1]=U;G[1][2]=T+1;G[2][0]=V;G[2][1]=U+1;G[2][2]=T+1}else{if(N&&Y&&X&&R){G[0][0]=V+1;G[0][1]=U;G[0][2]=T+1;G[1][0]=V+1;G[1][1]=U;G[1][2]=T;G[2][0]=V;G[2][1]=U;G[2][2]=T}else{if(Y&&X&&M&&S){G[0][0]=V;G[0][1]=U;G[0][2]=T+1;G[1][0]=V+1;G[1][1]=U;G[1][2]=T+1;G[2][0]=V+1;G[2][1]=U;G[2][2]=T}else{if(N&&X&&M&&L){G[0][0]=V;G[0][1]=U;G[0][2]=T;G[1][0]=V;G[1][1]=U;G[1][2]=T+1;G[2][0]=V+1;G[2][1]=U;G[2][2]=T+1}else{if(N&&Y&&M&&K){G[0][0]=V+1;G[0][1]=U;G[0][2]=T;G[1][0]=V;G[1][1]=U;G[1][2]=T;G[2][0]=V;G[2][1]=U;G[2][2]=T+1}else{if(L&&Y&&K&&M){G[0][0]=V+1;G[0][1]=U+1;G[0][2]=T+1;G[1][0]=V+1;G[1][1]=U+1;G[1][2]=T;G[2][0]=V+1;G[2][1]=U;G[2][2]=T}else{if(L&&X&&K&&N){G[0][0]=V+1;G[0][1]=U;G[0][2]=T+1;G[1][0]=V+1;G[1][1]=U+1;G[1][2]=T+1;G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T}else{if(Y&&X&&K&&S){G[0][0]=V+1;G[0][1]=U;G[0][2]=T;G[1][0]=V+1;G[1][1]=U;G[1][2]=T+1;G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T+1}else{if(L&&Y&&X&&R){G[0][0]=V+1;G[0][1]=U+1;G[0][2]=T;G[1][0]=V+1;G[1][1]=U;G[1][2]=T;G[2][0]=V+1;G[2][1]=U;G[2][2]=T+1}else{if(L&&S&&R&&X){G[0][0]=V;G[0][1]=U+1;G[0][2]=T+1;G[1][0]=V;G[1][1]=U+1;G[1][2]=T;G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T}else{if(S&&R&&K&&Y){G[0][0]=V+1;G[0][1]=U+1;G[0][2]=T+1;G[1][0]=V;G[1][1]=U+1;G[1][2]=T+1;G[2][0]=V;G[2][1]=U+1;G[2][2]=T}else{if(L&&R&&K&&N){G[0][0]=V+1;G[0][1]=U+1;G[0][2]=T;G[1][0]=V+1;G[1][1]=U+1;G[1][2]=T+1;G[2][0]=V;G[2][1]=U+1;G[2][2]=T+1}else{if(L&&S&&K&&M){G[0][0]=V;G[0][1]=U+1;G[0][2]=T;G[1][0]=V+1;G[1][1]=U+1;G[1][2]=T;G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T+1}else{if(N&&S&&M&&K){G[0][0]=V;G[0][1]=U;G[0][2]=T+1;G[1][0]=V;G[1][1]=U;G[1][2]=T;G[2][0]=V;G[2][1]=U+1;G[2][2]=T}else{if(N&&M&&R&&L){G[0][0]=V;G[0][1]=U+1;G[0][2]=T+1;G[1][0]=V;G[1][1]=U;G[1][2]=T+1;G[2][0]=V;G[2][1]=U;G[2][2]=T}else{if(M&&S&&R&&Y){G[0][0]=V;G[0][1]=U+1;G[0][2]=T;G[1][0]=V;G[1][1]=U+1;G[1][2]=T+1;G[2][0]=V;G[2][1]=U;G[2][2]=T+1}else{if(N&&S&&R&&X){G[0][0]=V;G[0][1]=U;G[0][2]=T;G[1][0]=V;G[1][1]=U+1;G[1][2]=T;G[2][0]=V;G[2][1]=U+1;G[2][2]=T+1}}}}}}}}}}}}}}}}}}}}}}}}for(Q=0;Q<3;++Q){if(P[G[Q][0]][G[Q][1]][G[Q][2]]==-1){P[G[Q][0]][G[Q][1]][G[Q][2]]=p;E.push(new v(G[Q][0],G[Q][1],G[Q][2]));p++}}a.push(new t(P[G[0][0]][G[0][1]][G[0][2]],P[G[1][0]][G[1][1]][G[1][2]],P[G[2][0]][G[2][1]][G[2][2]]));z++}else{if((N&&R&&L&&S)||(N&&Y&&L&&X)||(N&&M&&Y&&S)||(S&&Y&&L&&K)||(M&&R&&K&&S)||(M&&Y&&K&&X)||(N&&M&&X&&R)||(R&&X&&L&&K)){if(S&&R&&N&&L){G[0][0]=V;G[0][1]=U+1;G[0][2]=T+1;G[1][0]=V;G[1][1]=U;G[1][2]=T;G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T}else{if(Y&&X&&L&&N){G[0][0]=V+1;G[0][1]=U;G[0][2]=T+1;G[1][0]=V+1;G[1][1]=U+1;G[1][2]=T;G[2][0]=V;G[2][1]=U;G[2][2]=T}else{if(N&&M&&Y&&S){G[0][0]=V;G[0][1]=U;G[0][2]=T+1;G[1][0]=V+1;G[1][1]=U;G[1][2]=T;G[2][0]=V;G[2][1]=U+1;G[2][2]=T}else{if(L&&K&&S&&Y){G[0][0]=V+1;G[0][1]=U+1;G[0][2]=T+1;G[1][0]=V;G[1][1]=U+1;G[1][2]=T;G[2][0]=V+1;G[2][1]=U;G[2][2]=T}else{if(S&&R&&K&&M){G[0][0]=V;G[0][1]=U+1;G[0][2]=T;G[2][0]=V;G[2][1]=U;G[2][2]=T+1;G[1][0]=V+1;G[1][1]=U+1;G[1][2]=T+1}else{if(Y&&X&&K&&M){G[0][0]=V+1;G[0][1]=U;G[0][2]=T;G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T+1;G[1][0]=V;G[1][1]=U;G[1][2]=T+1}else{if(N&&M&&X&&R){G[0][0]=V;G[0][1]=U;G[0][2]=T;G[2][0]=V+1;G[2][1]=U;G[2][2]=T+1;G[1][0]=V;G[1][1]=U+1;G[1][2]=T+1}else{if(R&&X&&L&&K){G[0][0]=V+1;G[0][1]=U+1;G[0][2]=T;G[2][0]=V;G[2][1]=U+1;G[2][2]=T+1;G[1][0]=V+1;G[1][1]=U;G[1][2]=T+1}}}}}}}}for(Q=0;Q<3;++Q){if(P[G[Q][0]][G[Q][1]][G[Q][2]]==-1){P[G[Q][0]][G[Q][1]][G[Q][2]]=p;E.push(new v(G[Q][0],G[Q][1],G[Q][2]));p++}}a.push(new t(P[G[0][0]][G[0][1]][G[0][2]],P[G[1][0]][G[1][1]][G[1][2]],P[G[2][0]][G[2][1]][G[2][2]]));z++}else{if((N&&Y&&L&&M)||(S&&Y&&L&&X)||(S&&N&&L&&K)||(S&&N&&Y&&R)||(R&&M&&X&&Y)||(K&&M&&X&&L)||(K&&R&&X&&S)||(K&&R&&M&&N)||(L&&R&&M&&S)||(X&&N&&M&&S)||(X&&N&&K&&Y)||(R&&L&&K&&Y)){if(N&&Y&&L&&M){G[0][0]=V+1;G[0][1]=U;G[0][2]=T;G[1][0]=V+1;G[1][1]=U+1;G[1][2]=T;G[2][0]=V;G[2][1]=U;G[2][2]=T;G[3][0]=V;G[3][1]=U;G[3][2]=T+1}else{if(S&&Y&&L&&X){G[0][0]=V+1;G[0][1]=U+1;G[0][2]=T;G[1][0]=V;G[1][1]=U+1;G[1][2]=T;G[2][0]=V+1;G[2][1]=U;G[2][2]=T;G[3][0]=V+1;G[3][1]=U;G[3][2]=T+1}else{if(S&&N&&L&&K){G[0][0]=V;G[0][1]=U+1;G[0][2]=T;G[1][0]=V;G[1][1]=U;G[1][2]=T;G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T;G[3][0]=V+1;G[3][1]=U+1;G[3][2]=T+1}else{if(S&&N&&Y&&R){G[0][0]=V;G[0][1]=U;G[0][2]=T;G[1][0]=V+1;G[1][1]=U;G[1][2]=T;G[2][0]=V;G[2][1]=U+1;G[2][2]=T;G[3][0]=V;G[3][1]=U+1;G[3][2]=T+1}else{if(R&&M&&X&&Y){G[0][0]=V+1;G[0][1]=U;G[0][2]=T+1;G[1][0]=V+1;G[1][1]=U;G[1][2]=T;G[2][0]=V;G[2][1]=U;G[2][2]=T+1;G[3][0]=V;G[3][1]=U+1;G[3][2]=T+1}else{if(K&&M&&X&&L){G[0][0]=V+1;G[0][1]=U+1;G[0][2]=T+1;G[1][0]=V+1;G[1][1]=U+1;G[1][2]=T;G[2][0]=V+1;G[2][1]=U;G[2][2]=T+1;G[3][0]=V;G[3][1]=U;G[3][2]=T+1}else{if(K&&R&&X&&S){G[0][0]=V;G[0][1]=U+1;G[0][2]=T+1;G[1][0]=V;G[1][1]=U+1;G[1][2]=T;G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T+1;G[3][0]=V+1;G[3][1]=U;G[3][2]=T+1}else{if(K&&R&&M&&N){G[0][0]=V;G[0][1]=U;G[0][2]=T+1;G[1][0]=V;G[1][1]=U;G[1][2]=T;G[2][0]=V;G[2][1]=U+1;G[2][2]=T+1;G[3][0]=V+1;G[3][1]=U+1;G[3][2]=T+1}else{if(L&&R&&M&&S){G[0][0]=V;G[0][1]=U+1;G[0][2]=T;G[1][0]=V+1;G[1][1]=U+1;G[1][2]=T;G[2][0]=V;G[2][1]=U+1;G[2][2]=T+1;G[3][0]=V;G[3][1]=U;G[3][2]=T+1}else{if(X&&N&&M&&S){G[0][0]=V;G[0][1]=U;G[0][2]=T;G[1][0]=V;G[1][1]=U+1;G[1][2]=T;G[2][0]=V;G[2][1]=U;G[2][2]=T+1;G[3][0]=V+1;G[3][1]=U;G[3][2]=T+1}else{if(X&&N&&K&&Y){G[0][0]=V+1;G[0][1]=U;G[0][2]=T;G[1][0]=V;G[1][1]=U;G[1][2]=T;G[2][0]=V+1;G[2][1]=U;G[2][2]=T+1;G[3][0]=V+1;G[3][1]=U+1;G[3][2]=T+1}else{if(R&&L&&K&&Y){G[0][0]=V+1;G[0][1]=U+1;G[0][2]=T;G[1][0]=V+1;G[1][1]=U;G[1][2]=T;G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T+1;G[3][0]=V;G[3][1]=U+1;G[3][2]=T+1}}}}}}}}}}}}for(Q=0;Q<4;++Q){if(P[G[Q][0]][G[Q][1]][G[Q][2]]==-1){P[G[Q][0]][G[Q][1]][G[Q][2]]=p;E.push(new v(G[Q][0],G[Q][1],G[Q][2]));p++}}a.push(new t(P[G[0][0]][G[0][1]][G[0][2]],P[G[1][0]][G[1][1]][G[1][2]],P[G[2][0]][G[2][1]][G[2][2]]));z++;a.push(new t(P[G[0][0]][G[0][1]][G[0][2]],P[G[2][0]][G[2][1]][G[2][2]],P[G[3][0]][G[3][1]][G[3][2]]));z++}else{if((N&&Y&&S&&X)||(N&&Y&&L&&K)||(S&&Y&&L&&R)||(S&&N&&L&&M)||(K&&M&&X&&N)||(K&&R&&X&&Y)||(K&&R&&M&&L)||(X&&R&&M&&S)||(K&&R&&N&&S)||(Y&&N&&M&&R)||(X&&M&&L&&Y)||(S&&L&&K&&X)){if(N&&Y&&S&&X){G[0][0]=V+1;G[0][1]=U;G[0][2]=T;G[1][0]=V;G[1][1]=U+1;G[1][2]=T;G[2][0]=V;G[2][1]=U;G[2][2]=T;G[3][0]=V+1;G[3][1]=U;G[3][2]=T+1}else{if(N&&Y&&L&&K){G[0][0]=V+1;G[0][1]=U+1;G[0][2]=T;G[1][0]=V;G[1][1]=U;G[1][2]=T;G[2][0]=V+1;G[2][1]=U;G[2][2]=T;G[3][0]=V+1;G[3][1]=U+1;G[3][2]=T+1}else{if(S&&Y&&L&&R){G[0][0]=V;G[0][1]=U+1;G[0][2]=T;G[1][0]=V+1;G[1][1]=U;G[1][2]=T;G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T;G[3][0]=V;G[3][1]=U+1;G[3][2]=T+1}else{if(S&&N&&L&&M){G[0][0]=V;G[0][1]=U;G[0][2]=T;G[1][0]=V+1;G[1][1]=U+1;G[1][2]=T;G[2][0]=V;G[2][1]=U+1;G[2][2]=T;G[3][0]=V;G[3][1]=U;G[3][2]=T+1}else{if(K&&M&&X&&N){G[0][0]=V+1;G[0][1]=U;G[0][2]=T+1;G[1][0]=V;G[1][1]=U;G[1][2]=T;G[2][0]=V;G[2][1]=U;G[2][2]=T+1;G[3][0]=V+1;G[3][1]=U+1;G[3][2]=T+1}else{if(K&&R&&X&&Y){G[0][0]=V+1;G[0][1]=U+1;G[0][2]=T+1;G[1][0]=V+1;G[1][1]=U;G[1][2]=T;G[2][0]=V+1;G[2][1]=U;G[2][2]=T+1;G[3][0]=V;G[3][1]=U+1;G[3][2]=T+1}else{if(K&&R&&M&&L){G[0][0]=V;G[0][1]=U+1;G[0][2]=T+1;G[1][0]=V+1;G[1][1]=U+1;G[1][2]=T;G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T+1;G[3][0]=V;G[3][1]=U;G[3][2]=T+1}else{if(X&&R&&M&&S){G[0][0]=V;G[0][1]=U;G[0][2]=T+1;G[1][0]=V;G[1][1]=U+1;G[1][2]=T;G[2][0]=V;G[2][1]=U+1;G[2][2]=T+1;G[3][0]=V+1;G[3][1]=U;G[3][2]=T+1}else{if(K&&R&&N&&S){G[0][0]=V;G[0][1]=U+1;G[0][2]=T;G[1][0]=V+1;G[1][1]=U+1;G[1][2]=T+1;G[2][0]=V;G[2][1]=U+1;G[2][2]=T+1;G[3][0]=V;G[3][1]=U;G[3][2]=T}else{if(Y&&N&&M&&R){G[0][0]=V;G[0][1]=U;G[0][2]=T;G[1][0]=V;G[1][1]=U+1;G[1][2]=T+1;G[2][0]=V;G[2][1]=U;G[2][2]=T+1;G[3][0]=V+1;G[3][1]=U;G[3][2]=T}else{if(X&&M&&L&&Y){G[0][0]=V+1;G[0][1]=U;G[0][2]=T;G[1][0]=V;G[1][1]=U;G[1][2]=T+1;G[2][0]=V+1;G[2][1]=U;G[2][2]=T+1;G[3][0]=V+1;G[3][1]=U+1;G[3][2]=T}else{if(S&&L&&K&&X){G[0][0]=V+1;G[0][1]=U+1;G[0][2]=T;G[1][0]=V+1;G[1][1]=U;G[1][2]=T+1;G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T+1;G[3][0]=V;G[3][1]=U+1;G[3][2]=T}}}}}}}}}}}}for(Q=0;Q<4;++Q){if(P[G[Q][0]][G[Q][1]][G[Q][2]]==-1){P[G[Q][0]][G[Q][1]][G[Q][2]]=p;E.push(new v(G[Q][0],G[Q][1],G[Q][2]));p++}}a.push(new t(P[G[0][0]][G[0][1]][G[0][2]],P[G[1][0]][G[1][1]][G[1][2]],P[G[2][0]][G[2][1]][G[2][2]]));z++;a.push(new t(P[G[0][0]][G[0][1]][G[0][2]],P[G[2][0]][G[2][1]][G[2][2]],P[G[3][0]][G[3][1]][G[3][2]]));z++}}}}}}else{if(O==5){if((!Y&&!M&&!K)||(!S&&!M&&!K)||(!L&&!X&&!R)||(!N&&!X&&!R)||(!X&&!N&&!L)||(!R&&!N&&!L)||(!K&&!Y&&!S)||(!M&&!Y&&!S)){if(!Y&&!M&&!K){G[0][0]=V;G[0][1]=U+1;G[0][2]=T+1;G[1][0]=V;G[1][1]=U;G[1][2]=T;G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T}else{if(!S&&!M&&!K){G[0][0]=V+1;G[0][1]=U;G[0][2]=T+1;G[1][0]=V+1;G[1][1]=U+1;G[1][2]=T;G[2][0]=V;G[2][1]=U;G[2][2]=T}else{if(!L&&!X&&!R){G[0][0]=V;G[0][1]=U;G[0][2]=T+1;G[1][0]=V+1;G[1][1]=U;G[1][2]=T;G[2][0]=V;G[2][1]=U+1;G[2][2]=T}else{if(!N&&!X&&!R){G[0][0]=V+1;G[0][1]=U+1;G[0][2]=T+1;G[1][0]=V;G[1][1]=U+1;G[1][2]=T;G[2][0]=V+1;G[2][1]=U;G[2][2]=T}else{if(!X&&!N&&!L){G[0][0]=V;G[0][1]=U+1;G[0][2]=T;G[2][0]=V;G[2][1]=U;G[2][2]=T+1;G[1][0]=V+1;G[1][1]=U+1;G[1][2]=T+1}else{if(!R&&!N&&!L){G[0][0]=V+1;G[0][1]=U;G[0][2]=T;G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T+1;G[1][0]=V;G[1][1]=U;G[1][2]=T+1}else{if(!K&&!Y&&!S){G[0][0]=V;G[0][1]=U;G[0][2]=T;G[2][0]=V+1;G[2][1]=U;G[2][2]=T+1;G[1][0]=V;G[1][1]=U+1;G[1][2]=T+1}else{if(!M&&!Y&&!S){G[0][0]=V+1;G[0][1]=U+1;G[0][2]=T;G[2][0]=V;G[2][1]=U+1;G[2][2]=T+1;G[1][0]=V+1;G[1][1]=U;G[1][2]=T+1}}}}}}}}for(Q=0;Q<3;++Q){if(P[G[Q][0]][G[Q][1]][G[Q][2]]==-1){P[G[Q][0]][G[Q][1]][G[Q][2]]=p;E.push(new v(G[Q][0],G[Q][1],G[Q][2]));p++}}a.push(new t(P[G[0][0]][G[0][1]][G[0][2]],P[G[1][0]][G[1][1]][G[1][2]],P[G[2][0]][G[2][1]][G[2][2]]));z++}else{if((!N&&!Y&&!L)||(!N&&!S&&!L)||(!S&&!Y&&!L)||(!N&&!S&&!Y)||(!M&&!X&&!K)||(!M&&!R&&!K)||(!R&&!X&&!K)||(!M&&!R&&!X)||(!N&&!Y&&!X)||(!Y&&!X&&!M)||(!N&&!X&&!M)||(!N&&!Y&&!M)||(!L&&!Y&&!K)||(!L&&!X&&!K)||(!Y&&!X&&!K)||(!L&&!Y&&!X)||(!L&&!S&&!R)||(!S&&!R&&!K)||(!L&&!R&&!K)||(!L&&!S&&!K)||(!N&&!S&&!M)||(!N&&!M&&!R)||(!M&&!S&&!R)||(!N&&!S&&!R)){if(!N&&!Y&&!L){G[2][0]=V;G[2][1]=U;G[2][2]=T+1;G[1][0]=V+1;G[1][1]=U;G[1][2]=T+1;G[0][0]=V+1;G[0][1]=U+1;G[0][2]=T+1;G[3][0]=V;G[3][1]=U+1;G[3][2]=T}else{if(!N&&!S&&!L){G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T+1;G[1][0]=V;G[1][1]=U+1;G[1][2]=T+1;G[0][0]=V;G[0][1]=U;G[0][2]=T+1;G[3][0]=V+1;G[3][1]=U;G[3][2]=T}else{if(!S&&!Y&&!L){G[2][0]=V+1;G[2][1]=U;G[2][2]=T+1;G[1][0]=V+1;G[1][1]=U+1;G[1][2]=T+1;G[0][0]=V;G[0][1]=U+1;G[0][2]=T+1;G[3][0]=V;G[3][1]=U;G[3][2]=T}else{if(!N&&!S&&!Y){G[2][0]=V;G[2][1]=U+1;G[2][2]=T+1;G[1][0]=V;G[1][1]=U;G[1][2]=T+1;G[0][0]=V+1;G[0][1]=U;G[0][2]=T+1;G[3][0]=V+1;G[3][1]=U+1;G[3][2]=T}else{if(!M&&!X&&!K){G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T;G[1][0]=V+1;G[1][1]=U;G[1][2]=T;G[0][0]=V;G[0][1]=U;G[0][2]=T;G[3][0]=V;G[3][1]=U+1;G[3][2]=T+1}else{if(!M&&!R&&!K){G[2][0]=V;G[2][1]=U;G[2][2]=T;G[1][0]=V;G[1][1]=U+1;G[1][2]=T;G[0][0]=V+1;G[0][1]=U+1;G[0][2]=T;G[3][0]=V+1;G[3][1]=U;G[3][2]=T+1}else{if(!R&&!X&&!K){G[2][0]=V;G[2][1]=U+1;G[2][2]=T;G[1][0]=V+1;G[1][1]=U+1;G[1][2]=T;G[0][0]=V+1;G[0][1]=U;G[0][2]=T;G[3][0]=V;G[3][1]=U;G[3][2]=T+1}else{if(!M&&!R&&!X){G[2][0]=V+1;G[2][1]=U;G[2][2]=T;G[1][0]=V;G[1][1]=U;G[1][2]=T;G[0][0]=V;G[0][1]=U+1;G[0][2]=T;G[3][0]=V+1;G[3][1]=U+1;G[3][2]=T+1}else{if(!N&&!Y&&!X){G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T+1;G[1][0]=V+1;G[1][1]=U+1;G[1][2]=T;G[0][0]=V;G[0][1]=U+1;G[0][2]=T;G[3][0]=V;G[3][1]=U;G[3][2]=T+1}else{if(!Y&&!X&&!M){G[2][0]=V;G[2][1]=U+1;G[2][2]=T+1;G[1][0]=V+1;G[1][1]=U+1;G[1][2]=T+1;G[0][0]=V+1;G[0][1]=U+1;G[0][2]=T;G[3][0]=V;G[3][1]=U;G[3][2]=T}else{if(!N&&!X&&!M){G[2][0]=V;G[2][1]=U+1;G[2][2]=T;G[1][0]=V;G[1][1]=U+1;G[1][2]=T+1;G[0][0]=V+1;G[0][1]=U+1;G[0][2]=T+1;G[3][0]=V+1;G[3][1]=U;G[3][2]=T}else{if(!N&&!Y&&!M){G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T;G[1][0]=V;G[1][1]=U+1;G[1][2]=T;G[0][0]=V;G[0][1]=U+1;G[0][2]=T+1;G[3][0]=V+1;G[3][1]=U;G[3][2]=T+1}else{if(!L&&!Y&&!K){G[2][0]=V;G[2][1]=U+1;G[2][2]=T+1;G[1][0]=V;G[1][1]=U+1;G[1][2]=T;G[0][0]=V;G[0][1]=U;G[0][2]=T;G[3][0]=V+1;G[3][1]=U;G[3][2]=T+1}else{if(!L&&!X&&!K){G[2][0]=V;G[2][1]=U;G[2][2]=T+1;G[1][0]=V;G[1][1]=U+1;G[1][2]=T+1;G[0][0]=V;G[0][1]=U+1;G[0][2]=T;G[3][0]=V+1;G[3][1]=U;G[3][2]=T}else{if(!Y&&!X&&!K){G[2][0]=V;G[2][1]=U;G[2][2]=T;G[1][0]=V;G[1][1]=U;G[1][2]=T+1;G[0][0]=V;G[0][1]=U+1;G[0][2]=T+1;G[3][0]=V+1;G[3][1]=U+1;G[3][2]=T}else{if(!L&&!Y&&!X){G[2][0]=V;G[2][1]=U+1;G[2][2]=T;G[1][0]=V;G[1][1]=U;G[1][2]=T;G[0][0]=V;G[0][1]=U;G[0][2]=T+1;G[3][0]=V+1;G[3][1]=U+1;G[3][2]=T+1}else{if(!L&&!S&&!R){G[2][0]=V;G[2][1]=U;G[2][2]=T+1;G[1][0]=V;G[1][1]=U;G[1][2]=T;G[0][0]=V+1;G[0][1]=U;G[0][2]=T;G[3][0]=V+1;G[3][1]=U+1;G[3][2]=T+1}else{if(!S&&!R&&!K){G[2][0]=V+1;G[2][1]=U;G[2][2]=T+1;G[1][0]=V;G[1][1]=U;G[1][2]=T+1;G[0][0]=V;G[0][1]=U;G[0][2]=T;G[3][0]=V+1;G[3][1]=U+1;G[3][2]=T}else{if(!L&&!R&&!K){G[2][0]=V+1;G[2][1]=U;G[2][2]=T;G[1][0]=V+1;G[1][1]=U;G[1][2]=T+1;G[0][0]=V;G[0][1]=U;G[0][2]=T+1;G[3][0]=V;G[3][1]=U+1;G[3][2]=T}else{if(!L&&!S&&!K){G[2][0]=V;G[2][1]=U;G[2][2]=T;G[1][0]=V+1;G[1][1]=U;G[1][2]=T;G[0][0]=V+1;G[0][1]=U;G[0][2]=T+1;G[3][0]=V;G[3][1]=U+1;G[3][2]=T+1}else{if(!N&&!S&&!M){G[2][0]=V+1;G[2][1]=U;G[2][2]=T+1;G[1][0]=V+1;G[1][1]=U;G[1][2]=T;G[0][0]=V+1;G[0][1]=U+1;G[0][2]=T;G[3][0]=V;G[3][1]=U+1;G[3][2]=T+1}else{if(!N&&!M&&!R){G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T+1;G[1][0]=V+1;G[1][1]=U;G[1][2]=T+1;G[0][0]=V+1;G[0][1]=U;G[0][2]=T;G[3][0]=V;G[3][1]=U+1;G[3][2]=T}else{if(!M&&!S&&!R){G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T;G[1][0]=V+1;G[1][1]=U+1;G[1][2]=T+1;G[0][0]=V+1;G[0][1]=U;G[0][2]=T+1;G[3][0]=V;G[3][1]=U;G[3][2]=T}else{if(!N&&!S&&!R){G[2][0]=V+1;G[2][1]=U;G[2][2]=T;G[1][0]=V+1;G[1][1]=U+1;G[1][2]=T;G[0][0]=V+1;G[0][1]=U+1;G[0][2]=T+1;G[3][0]=V;G[3][1]=U;G[3][2]=T+1}}}}}}}}}}}}}}}}}}}}}}}}for(Q=0;Q<4;++Q){if(P[G[Q][0]][G[Q][1]][G[Q][2]]==-1){P[G[Q][0]][G[Q][1]][G[Q][2]]=p;E.push(new v(G[Q][0],G[Q][1],G[Q][2]));p++}}a.push(new t(P[G[0][0]][G[0][1]][G[0][2]],P[G[1][0]][G[1][1]][G[1][2]],P[G[2][0]][G[2][1]][G[2][2]]));z++;a.push(new t(P[G[0][0]][G[0][1]][G[0][2]],P[G[2][0]][G[2][1]][G[2][2]],P[G[3][0]][G[3][1]][G[3][2]]));z++}else{if((!N&&!Y&&!K)||(!S&&!L&&!M)||(!R&&!K&&!Y)||(!M&&!X&&!L)||(!N&&!S&&!K)||(!X&&!K&&!S)||(!Y&&!L&&!R)||(!M&&!R&&!L)||(!N&&!M&&!K)||(!L&&!K&&!N)||(!Y&&!X&&!R)||(!S&&!R&&!X)){if(!N&&!Y&&!K){G[0][0]=V;G[0][1]=U;G[0][2]=T+1;G[1][0]=V;G[1][1]=U+1;G[1][2]=T;G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T;G[3][0]=V+1;G[3][1]=U;G[3][2]=T+1;G[4][0]=V;G[4][1]=U+1;G[4][2]=T+1}else{if(!S&&!L&&!M){G[0][0]=V+1;G[0][1]=U+1;G[0][2]=T+1;G[1][0]=V+1;G[1][1]=U;G[1][2]=T;G[2][0]=V;G[2][1]=U;G[2][2]=T;G[3][0]=V;G[3][1]=U+1;G[3][2]=T+1;G[4][0]=V+1;G[4][1]=U;G[4][2]=T+1}else{if(!R&&!K&&!Y){G[0][0]=V;G[0][1]=U+1;G[0][2]=T;G[1][0]=V;G[1][1]=U;G[1][2]=T+1;G[2][0]=V+1;G[2][1]=U;G[2][2]=T+1;G[3][0]=V+1;G[3][1]=U+1;G[3][2]=T;G[4][0]=V;G[4][1]=U;G[4][2]=T}else{if(!M&&!X&&!L){G[0][0]=V;G[0][1]=U+1;G[0][2]=T+1;G[1][0]=V;G[1][1]=U;G[1][2]=T;G[2][0]=V+1;G[2][1]=U;G[2][2]=T;G[3][0]=V+1;G[3][1]=U+1;G[3][2]=T+1;G[4][0]=V;G[4][1]=U+1;G[4][2]=T}else{if(!N&&!S&&!K){G[1][0]=V;G[1][1]=U;G[1][2]=T+1;G[0][0]=V+1;G[0][1]=U;G[0][2]=T;G[3][0]=V+1;G[3][1]=U+1;G[3][2]=T;G[2][0]=V;G[2][1]=U+1;G[2][2]=T+1;G[4][0]=V+1;G[4][1]=U;G[4][2]=T+1}else{if(!X&&!K&&!S){G[0][0]=V;G[0][1]=U;G[0][2]=T+1;G[1][0]=V+1;G[1][1]=U;G[1][2]=T;G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T;G[3][0]=V;G[3][1]=U+1;G[3][2]=T+1;G[4][0]=V;G[4][1]=U;G[4][2]=T}else{if(!Y&&!L&&!R){G[0][0]=V+1;G[0][1]=U;G[0][2]=T+1;G[1][0]=V;G[1][1]=U;G[1][2]=T;G[2][0]=V;G[2][1]=U+1;G[2][2]=T;G[3][0]=V+1;G[3][1]=U+1;G[3][2]=T+1;G[4][0]=V;G[4][1]=U;G[4][2]=T+1}else{if(!M&&!R&&!L){G[0][0]=V;G[0][1]=U;G[0][2]=T;G[1][0]=V+1;G[1][1]=U;G[1][2]=T+1;G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T+1;G[3][0]=V;G[3][1]=U+1;G[3][2]=T;G[4][0]=V+1;G[4][1]=U;G[4][2]=T}else{if(!N&&!M&&!K){G[0][0]=V;G[0][1]=U+1;G[0][2]=T;G[1][0]=V+1;G[1][1]=U;G[1][2]=T;G[2][0]=V+1;G[2][1]=U;G[2][2]=T+1;G[3][0]=V;G[3][1]=U+1;G[3][2]=T+1;G[4][0]=V+1;G[4][1]=U+1;G[4][2]=T}else{if(!L&&!K&&!N){G[0][0]=V;G[0][1]=U+1;G[0][2]=T+1;G[1][0]=V+1;G[1][1]=U;G[1][2]=T+1;G[2][0]=V+1;G[2][1]=U;G[2][2]=T;G[3][0]=V;G[3][1]=U+1;G[3][2]=T;G[4][0]=V;G[4][1]=U;G[4][2]=T+1}else{if(!Y&&!X&&!R){G[0][0]=V;G[0][1]=U;G[0][2]=T;G[1][0]=V+1;G[1][1]=U+1;G[1][2]=T;G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T+1;G[3][0]=V;G[3][1]=U;G[3][2]=T+1;G[4][0]=V;G[4][1]=U+1;G[4][2]=T}else{if(!S&&!R&&!X){G[0][0]=V+1;G[0][1]=U+1;G[0][2]=T;G[1][0]=V;G[1][1]=U;G[1][2]=T;G[2][0]=V;G[2][1]=U;G[2][2]=T+1;G[3][0]=V+1;G[3][1]=U+1;G[3][2]=T+1;G[4][0]=V+1;G[4][1]=U;G[4][2]=T}}}}}}}}}}}}for(Q=0;Q<5;++Q){if(P[G[Q][0]][G[Q][1]][G[Q][2]]==-1){P[G[Q][0]][G[Q][1]][G[Q][2]]=p;E.push(new v(G[Q][0],G[Q][1],G[Q][2]));p++}}a.push(new t(P[G[0][0]][G[0][1]][G[0][2]],P[G[1][0]][G[1][1]][G[1][2]],P[G[2][0]][G[2][1]][G[2][2]]));z++;a.push(new t(P[G[0][0]][G[0][1]][G[0][2]],P[G[2][0]][G[2][1]][G[2][2]],P[G[3][0]][G[3][1]][G[3][2]]));z++;a.push(new t(P[G[2][0]][G[2][1]][G[2][2]],P[G[4][0]][G[4][1]][G[4][2]],P[G[3][0]][G[3][1]][G[3][2]]));z++}else{if((!N&&!Y&&!R)||(!S&&!L&&!X)||(!R&&!K&&!N)||(!M&&!X&&!S)||(!N&&!S&&!X)||(!X&&!K&&!N)||(!Y&&!L&&!M)||(!M&&!R&&!Y)||(!N&&!M&&!L)||(!L&&!K&&!M)||(!Y&&!X&&!S)||(!S&&!R&&!Y)){if(!N&&!Y&&!R){G[0][0]=V;G[0][1]=U;G[0][2]=T+1;G[1][0]=V;G[1][1]=U+1;G[1][2]=T;G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T;G[3][0]=V+1;G[3][1]=U;G[3][2]=T+1;G[4][0]=V+1;G[4][1]=U+1;G[4][2]=T+1}else{if(!S&&!L&&!X){G[0][0]=V+1;G[0][1]=U+1;G[0][2]=T+1;G[1][0]=V+1;G[1][1]=U;G[1][2]=T;G[2][0]=V;G[2][1]=U;G[2][2]=T;G[3][0]=V;G[3][1]=U+1;G[3][2]=T+1;G[4][0]=V;G[4][1]=U;G[4][2]=T+1}else{if(!R&&!K&&!N){G[0][0]=V;G[0][1]=U+1;G[0][2]=T;G[1][0]=V;G[1][1]=U;G[1][2]=T+1;G[2][0]=V+1;G[2][1]=U;G[2][2]=T+1;G[3][0]=V+1;G[3][1]=U+1;G[3][2]=T;G[4][0]=V+1;G[4][1]=U;G[4][2]=T}else{if(!M&&!X&&!S){G[0][0]=V;G[0][1]=U+1;G[0][2]=T+1;G[1][0]=V;G[1][1]=U;G[1][2]=T;G[2][0]=V+1;G[2][1]=U;G[2][2]=T;G[3][0]=V+1;G[3][1]=U+1;G[3][2]=T+1;G[4][0]=V+1;G[4][1]=U+1;G[4][2]=T}else{if(!N&&!S&&!X){G[1][0]=V;G[1][1]=U;G[1][2]=T+1;G[0][0]=V+1;G[0][1]=U;G[0][2]=T;G[3][0]=V+1;G[3][1]=U+1;G[3][2]=T;G[2][0]=V;G[2][1]=U+1;G[2][2]=T+1;G[4][0]=V+1;G[4][1]=U+1;G[4][2]=T+1}else{if(!X&&!K&&!N){G[0][0]=V;G[0][1]=U;G[0][2]=T+1;G[1][0]=V+1;G[1][1]=U;G[1][2]=T;G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T;G[3][0]=V;G[3][1]=U+1;G[3][2]=T+1;G[4][0]=V;G[4][1]=U+1;G[4][2]=T}else{if(!Y&&!L&&!M){G[0][0]=V+1;G[0][1]=U;G[0][2]=T+1;G[1][0]=V;G[1][1]=U;G[1][2]=T;G[2][0]=V;G[2][1]=U+1;G[2][2]=T;G[3][0]=V+1;G[3][1]=U+1;G[3][2]=T+1;G[4][0]=V;G[4][1]=U+1;G[4][2]=T+1}else{if(!M&&!R&&!Y){G[0][0]=V;G[0][1]=U;G[0][2]=T;G[1][0]=V+1;G[1][1]=U;G[1][2]=T+1;G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T+1;G[3][0]=V;G[3][1]=U+1;G[3][2]=T;G[4][0]=V+1;G[4][1]=U+1;G[4][2]=T}else{if(!N&&!M&&!L){G[0][0]=V;G[0][1]=U+1;G[0][2]=T;G[1][0]=V+1;G[1][1]=U;G[1][2]=T;G[2][0]=V+1;G[2][1]=U;G[2][2]=T+1;G[3][0]=V;G[3][1]=U+1;G[3][2]=T+1;G[4][0]=V+1;G[4][1]=U+1;G[4][2]=T+1}else{if(!L&&!K&&!M){G[0][0]=V;G[0][1]=U+1;G[0][2]=T+1;G[1][0]=V+1;G[1][1]=U;G[1][2]=T+1;G[2][0]=V+1;G[2][1]=U;G[2][2]=T;G[3][0]=V;G[3][1]=U+1;G[3][2]=T;G[4][0]=V;G[4][1]=U;G[4][2]=T}else{if(!Y&&!X&&!S){G[0][0]=V;G[0][1]=U;G[0][2]=T;G[1][0]=V+1;G[1][1]=U+1;G[1][2]=T;G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T+1;G[3][0]=V;G[3][1]=U;G[3][2]=T+1;G[4][0]=V;G[4][1]=U+1;G[4][2]=T+1}else{if(!S&&!R&&!Y){G[0][0]=V+1;G[0][1]=U+1;G[0][2]=T;G[1][0]=V;G[1][1]=U;G[1][2]=T;G[2][0]=V;G[2][1]=U;G[2][2]=T+1;G[3][0]=V+1;G[3][1]=U+1;G[3][2]=T+1;G[4][0]=V+1;G[4][1]=U;G[4][2]=T+1}}}}}}}}}}}}for(Q=0;Q<5;++Q){if(P[G[Q][0]][G[Q][1]][G[Q][2]]==-1){P[G[Q][0]][G[Q][1]][G[Q][2]]=p;E.push(new v(G[Q][0],G[Q][1],G[Q][2]));p++}}a.push(new t(P[G[0][0]][G[0][1]][G[0][2]],P[G[1][0]][G[1][1]][G[1][2]],P[G[2][0]][G[2][1]][G[2][2]]));z++;a.push(new t(P[G[0][0]][G[0][1]][G[0][2]],P[G[2][0]][G[2][1]][G[2][2]],P[G[3][0]][G[3][1]][G[3][2]]));z++;a.push(new t(P[G[0][0]][G[0][1]][G[0][2]],P[G[4][0]][G[4][1]][G[4][2]],P[G[1][0]][G[1][1]][G[1][2]]));z++}}}}}else{if(O==6){if((!N&&!Y)||(!S&&!L)||(!R&&!K)||(!M&&!X)||(!N&&!S)||(!X&&!K)||(!Y&&!L)||(!M&&!R)||(!N&&!M)||(!L&&!K)||(!Y&&!X)||(!S&&!R)){if(!N&&!Y){G[0][0]=V;G[0][1]=U;G[0][2]=T+1;G[3][0]=V+1;G[3][1]=U;G[3][2]=T+1;G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T;G[1][0]=V;G[1][1]=U+1;G[1][2]=T}else{if(!S&&!L){G[0][0]=V;G[0][1]=U;G[0][2]=T;G[3][0]=V+1;G[3][1]=U;G[3][2]=T;G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T+1;G[1][0]=V;G[1][1]=U+1;G[1][2]=T+1}else{if(!R&&!K){G[0][0]=V;G[0][1]=U;G[0][2]=T+1;G[1][0]=V+1;G[1][1]=U;G[1][2]=T+1;G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T;G[3][0]=V;G[3][1]=U+1;G[3][2]=T}else{if(!M&&!X){G[0][0]=V;G[0][1]=U;G[0][2]=T;G[1][0]=V+1;G[1][1]=U;G[1][2]=T;G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T+1;G[3][0]=V;G[3][1]=U+1;G[3][2]=T+1}else{if(!N&&!S){G[0][0]=V;G[0][1]=U;G[0][2]=T+1;G[1][0]=V;G[1][1]=U+1;G[1][2]=T+1;G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T;G[3][0]=V+1;G[3][1]=U;G[3][2]=T}else{if(!X&&!K){G[0][0]=V;G[0][1]=U;G[0][2]=T+1;G[3][0]=V;G[3][1]=U+1;G[3][2]=T+1;G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T;G[1][0]=V+1;G[1][1]=U;G[1][2]=T}else{if(!Y&&!L){G[0][0]=V+1;G[0][1]=U+1;G[0][2]=T+1;G[1][0]=V+1;G[1][1]=U;G[1][2]=T+1;G[2][0]=V;G[2][1]=U;G[2][2]=T;G[3][0]=V;G[3][1]=U+1;G[3][2]=T}else{if(!M&&!R){G[0][0]=V+1;G[0][1]=U+1;G[0][2]=T+1;G[3][0]=V+1;G[3][1]=U;G[3][2]=T+1;G[2][0]=V;G[2][1]=U;G[2][2]=T;G[1][0]=V;G[1][1]=U+1;G[1][2]=T}else{if(!N&&!M){G[0][0]=V+1;G[0][1]=U;G[0][2]=T+1;G[1][0]=V;G[1][1]=U+1;G[1][2]=T+1;G[2][0]=V;G[2][1]=U+1;G[2][2]=T;G[3][0]=V+1;G[3][1]=U;G[3][2]=T}else{if(!L&&!K){G[0][0]=V+1;G[0][1]=U;G[0][2]=T+1;G[3][0]=V;G[3][1]=U+1;G[3][2]=T+1;G[2][0]=V;G[2][1]=U+1;G[2][2]=T;G[1][0]=V+1;G[1][1]=U;G[1][2]=T}else{if(!Y&&!X){G[0][0]=V+1;G[0][1]=U+1;G[0][2]=T+1;G[1][0]=V;G[1][1]=U;G[1][2]=T+1;G[2][0]=V;G[2][1]=U;G[2][2]=T;G[3][0]=V+1;G[3][1]=U+1;G[3][2]=T}else{if(!S&&!R){G[0][0]=V+1;G[0][1]=U+1;G[0][2]=T+1;G[3][0]=V;G[3][1]=U;G[3][2]=T+1;G[2][0]=V;G[2][1]=U;G[2][2]=T;G[1][0]=V+1;G[1][1]=U+1;G[1][2]=T}}}}}}}}}}}}for(Q=0;Q<4;++Q){if(P[G[Q][0]][G[Q][1]][G[Q][2]]==-1){P[G[Q][0]][G[Q][1]][G[Q][2]]=p;E.push(new v(G[Q][0],G[Q][1],G[Q][2]));p++}}a.push(new t(P[G[0][0]][G[0][1]][G[0][2]],P[G[1][0]][G[1][1]][G[1][2]],P[G[2][0]][G[2][1]][G[2][2]]));z++;a.push(new t(P[G[0][0]][G[0][1]][G[0][2]],P[G[2][0]][G[2][1]][G[2][2]],P[G[3][0]][G[3][1]][G[3][2]]));z++}else{if((!N&&!K)||(!Y&&!R)||(!S&&!X)||(!L&&!M)){if(!N&&!K){G[0][0]=V;G[0][1]=U+1;G[0][2]=T+1;G[1][0]=V+1;G[1][1]=U;G[1][2]=T+1;G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T;G[3][0]=V;G[3][1]=U;G[3][2]=T+1;G[4][0]=V;G[4][1]=U+1;G[4][2]=T;G[5][0]=V+1;G[5][1]=U;G[5][2]=T}else{if(!Y&&!R){G[0][0]=V;G[0][1]=U;G[0][2]=T+1;G[1][0]=V+1;G[1][1]=U+1;G[1][2]=T+1;G[2][0]=V;G[2][1]=U+1;G[2][2]=T;G[3][0]=V+1;G[3][1]=U;G[3][2]=T+1;G[4][0]=V;G[4][1]=U;G[4][2]=T;G[5][0]=V+1;G[5][1]=U+1;G[5][2]=T}else{if(!S&&!X){G[0][0]=V+1;G[0][1]=U+1;G[0][2]=T+1;G[1][0]=V;G[1][1]=U;G[1][2]=T+1;G[2][0]=V+1;G[2][1]=U;G[2][2]=T;G[3][0]=V;G[3][1]=U+1;G[3][2]=T+1;G[4][0]=V+1;G[4][1]=U+1;G[4][2]=T;G[5][0]=V;G[5][1]=U;G[5][2]=T}else{if(!L&&!M){G[0][0]=V+1;G[0][1]=U;G[0][2]=T+1;G[1][0]=V;G[1][1]=U+1;G[1][2]=T+1;G[2][0]=V;G[2][1]=U;G[2][2]=T;G[3][0]=V+1;G[3][1]=U+1;G[3][2]=T+1;G[4][0]=V+1;G[4][1]=U;G[4][2]=T;G[5][0]=V;G[5][1]=U+1;G[5][2]=T}}}}for(Q=0;Q<6;++Q){if(P[G[Q][0]][G[Q][1]][G[Q][2]]==-1){P[G[Q][0]][G[Q][1]][G[Q][2]]=p;E.push(new v(G[Q][0],G[Q][1],G[Q][2]));p++}}a.push(new t(P[G[0][0]][G[0][1]][G[0][2]],P[G[1][0]][G[1][1]][G[1][2]],P[G[2][0]][G[2][1]][G[2][2]]));z++;a.push(new t(P[G[3][0]][G[3][1]][G[3][2]],P[G[4][0]][G[4][1]][G[4][2]],P[G[5][0]][G[5][1]][G[5][2]]));z++}else{if((!N&&!X)||(!Y&&!M)||(!Y&&!K)||(!L&&!X)||(!L&&!R)||(!S&&!K)||(!S&&!M)||(!N&&!R)||(!M&&!K)||(!X&&!R)||(!N&&!L)||(!Y&&!S)){if(!N&&!X){G[0][0]=V;G[0][1]=U;G[0][2]=T+1;G[2][0]=V+1;G[2][1]=U;G[2][2]=T;G[1][0]=V;G[1][1]=U+1;G[1][2]=T;G[3][0]=V+1;G[3][1]=U+1;G[3][2]=T+1}else{if(!Y&&!M){G[0][0]=V+1;G[0][1]=U;G[0][2]=T+1;G[2][0]=V;G[2][1]=U;G[2][2]=T;G[1][0]=V;G[1][1]=U+1;G[1][2]=T+1;G[3][0]=V+1;G[3][1]=U+1;G[3][2]=T}else{if(!Y&&!K){G[0][0]=V+1;G[0][1]=U;G[0][2]=T+1;G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T;G[1][0]=V;G[1][1]=U;G[1][2]=T;G[3][0]=V;G[3][1]=U+1;G[3][2]=T+1}else{if(!L&&!X){G[0][0]=V+1;G[0][1]=U+1;G[0][2]=T+1;G[2][0]=V+1;G[2][1]=U;G[2][2]=T;G[1][0]=V;G[1][1]=U;G[1][2]=T+1;G[3][0]=V;G[3][1]=U+1;G[3][2]=T}else{if(!L&&!R){G[0][0]=V+1;G[0][1]=U+1;G[0][2]=T+1;G[2][0]=V;G[2][1]=U+1;G[2][2]=T;G[1][0]=V+1;G[1][1]=U;G[1][2]=T;G[3][0]=V;G[3][1]=U;G[3][2]=T+1}else{if(!S&&!K){G[0][0]=V;G[0][1]=U+1;G[0][2]=T+1;G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T;G[1][0]=V+1;G[1][1]=U;G[1][2]=T+1;G[3][0]=V;G[3][1]=U;G[3][2]=T}else{if(!S&&!M){G[0][0]=V;G[0][1]=U+1;G[0][2]=T+1;G[2][0]=V;G[2][1]=U;G[2][2]=T;G[1][0]=V+1;G[1][1]=U+1;G[1][2]=T;G[3][0]=V+1;G[3][1]=U;G[3][2]=T+1}else{if(!N&&!R){G[0][0]=V;G[0][1]=U;G[0][2]=T+1;G[2][0]=V;G[2][1]=U+1;G[2][2]=T;G[1][0]=V+1;G[1][1]=U+1;G[1][2]=T+1;G[3][0]=V+1;G[3][1]=U;G[3][2]=T}else{if(!M&&!K){G[0][0]=V;G[0][1]=U+1;G[0][2]=T+1;G[2][0]=V+1;G[2][1]=U;G[2][2]=T+1;G[1][0]=V;G[1][1]=U;G[1][2]=T;G[3][0]=V+1;G[3][1]=U+1;G[3][2]=T}else{if(!X&&!R){G[0][0]=V;G[0][1]=U;G[0][2]=T+1;G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T+1;G[1][0]=V+1;G[1][1]=U;G[1][2]=T;G[3][0]=V;G[3][1]=U+1;G[3][2]=T}else{if(!N&&!L){G[0][0]=V;G[0][1]=U+1;G[0][2]=T;G[2][0]=V+1;G[2][1]=U;G[2][2]=T;G[1][0]=V+1;G[1][1]=U+1;G[1][2]=T+1;G[3][0]=V;G[3][1]=U;G[3][2]=T+1}else{if(!Y&&!S){G[0][0]=V;G[0][1]=U;G[0][2]=T;G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T;G[1][0]=V;G[1][1]=U+1;G[1][2]=T+1;G[3][0]=V+1;G[3][1]=U;G[3][2]=T+1}}}}}}}}}}}}for(Q=0;Q<4;++Q){if(P[G[Q][0]][G[Q][1]][G[Q][2]]==-1){P[G[Q][0]][G[Q][1]][G[Q][2]]=p;E.push(new v(G[Q][0],G[Q][1],G[Q][2]));p++}}a.push(new t(P[G[0][0]][G[0][1]][G[0][2]],P[G[1][0]][G[1][1]][G[1][2]],P[G[2][0]][G[2][1]][G[2][2]]));z++;a.push(new t(P[G[0][0]][G[0][1]][G[0][2]],P[G[2][0]][G[2][1]][G[2][2]],P[G[3][0]][G[3][1]][G[3][2]]));z++}}}}else{if(O==7){if(!N){G[0][0]=V;G[0][1]=U+1;G[0][2]=T;G[1][0]=V+1;G[1][1]=U;G[1][2]=T;G[2][0]=V;G[2][1]=U;G[2][2]=T+1}else{if(!Y){G[0][0]=V;G[0][1]=U;G[0][2]=T;G[1][0]=V+1;G[1][1]=U+1;G[1][2]=T;G[2][0]=V+1;G[2][1]=U;G[2][2]=T+1}else{if(!L){G[0][0]=V+1;G[0][1]=U;G[0][2]=T;G[1][0]=V;G[1][1]=U+1;G[1][2]=T;G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T+1}else{if(!S){G[0][0]=V+1;G[0][1]=U+1;G[0][2]=T;G[1][0]=V;G[1][1]=U;G[1][2]=T;G[2][0]=V;G[2][1]=U+1;G[2][2]=T+1}else{if(!M){G[0][0]=V+1;G[0][1]=U;G[0][2]=T+1;G[1][0]=V;G[1][1]=U+1;G[1][2]=T+1;G[2][0]=V;G[2][1]=U;G[2][2]=T}else{if(!X){G[0][0]=V+1;G[0][1]=U+1;G[0][2]=T+1;G[1][0]=V;G[1][1]=U;G[1][2]=T+1;G[2][0]=V+1;G[2][1]=U;G[2][2]=T}else{if(!K){G[0][0]=V;G[0][1]=U+1;G[0][2]=T+1;G[1][0]=V+1;G[1][1]=U;G[1][2]=T+1;G[2][0]=V+1;G[2][1]=U+1;G[2][2]=T}else{if(!R){G[0][0]=V;G[0][1]=U;G[0][2]=T+1;G[1][0]=V+1;G[1][1]=U+1;G[1][2]=T+1;G[2][0]=V;G[2][1]=U+1;G[2][2]=T}}}}}}}}for(Q=0;Q<3;++Q){if(P[G[Q][0]][G[Q][1]][G[Q][2]]==-1){P[G[Q][0]][G[Q][1]][G[Q][2]]=p;E.push(new v(G[Q][0],G[Q][1],G[Q][2]));p++}}a.push(new t(P[G[0][0]][G[0][1]][G[0][2]],P[G[1][0]][G[1][1]][G[1][2]],P[G[2][0]][G[2][1]][G[2][2]]));z++}}}}}}}}this.faces=a;this.verts=E;for(V=0;V<p;++V){E[V].atomid=u[E[V].x*s*l+l*E[V].y+E[V].z].atomid}};this.laplaciansmooth=function(Q){var I=new Array(p);for(var M=0;M<p;++M){I[M]={x:0,y:0,z:0}}var G=new Array(20);var N;for(var M=0;M<20;++M){G[M]=new Array(p)}for(var M=0;M<p;++M){G[0][M]=0}for(var M=0;M<z;++M){N=true;for(var L=0;L<G[0][a[M].a];++L){if(a[M].b==G[L+1][a[M].a]){N=false;break}}if(N){G[0][a[M].a]++;G[G[0][a[M].a]][a[M].a]=a[M].b}N=true;for(var L=0;L<G[0][a[M].a];++L){if(a[M].c==G[L+1][a[M].a]){N=false;break}}if(N){G[0][a[M].a]++;G[G[0][a[M].a]][a[M].a]=a[M].c}N=true;for(L=0;L<G[0][a[M].b];++L){if(a[M].a==G[L+1][a[M].b]){N=false;break}}if(N){G[0][a[M].b]++;G[G[0][a[M].b]][a[M].b]=a[M].a}N=true;for(L=0;L<G[0][a[M].b];++L){if(a[M].c==G[L+1][a[M].b]){N=false;break}}if(N){G[0][a[M].b]++;G[G[0][a[M].b]][a[M].b]=a[M].c}N=true;for(L=0;L<G[0][a[M].c];++L){if(a[M].a==G[L+1][a[M].c]){N=false;break}}if(N){G[0][a[M].c]++;G[G[0][a[M].c]][a[M].c]=a[M].a}N=true;for(L=0;L<G[0][a[M].c];++L){if(a[M].b==G[L+1][a[M].c]){N=false;break}}if(N){G[0][a[M].c]++;G[G[0][a[M].c]][a[M].c]=a[M].b}}var O=1;var K=0.5;var H;var P=0.75/(c+3.5);for(var J=0;J<Q;++J){for(var M=0;M<p;++M){if(G[0][M]<3){I[M].x=E[M].x;I[M].y=E[M].y;I[M].z=E[M].z}else{if(G[0][M]==3||G[0][M]==4){I[M].x=0;I[M].y=0;I[M].z=0;for(L=0;L<G[0][M];++L){I[M].x+=E[G[L+1][M]].x;I[M].y+=E[G[L+1][M]].y;I[M].z+=E[G[L+1][M]].z}I[M].x+=K*E[M].x;I[M].y+=K*E[M].y;I[M].z+=K*E[M].z;I[M].x/=K+G[0][M];I[M].y/=K+G[0][M];I[M].z/=K+G[0][M]}else{I[M].x=0;I[M].y=0;I[M].z=0;for(var L=0;L<G[0][M];++L){I[M].x+=E[G[L+1][M]].x;I[M].y+=E[G[L+1][M]].y;I[M].z+=E[G[L+1][M]].z}I[M].x+=O*E[M].x;I[M].y+=O*E[M].y;I[M].z+=O*E[M].z;I[M].x/=O+G[0][M];I[M].y/=O+G[0][M];I[M].z/=O+G[0][M]}}}for(var M=0;M<p;++M){E[M].x=I[M].x;E[M].y=I[M].y;E[M].z=I[M].z}}};this.transformVertices=function(){var G=this.verts;var I=1/c;for(var H=0;H<p;++H){G[H].x=G[H].x*I-y;G[H].y=G[H].y*I-x;G[H].z=G[H].z*I-w}};initparm(F.min,F.max,F.type>1);fillvoxels(F.atoms);buildboundary();if(F.type==4||F.type==2){fastdistancemap()}if(F.type==2){boundingatom(false);fillvoxelswaals(F.atoms)}marchingcube(F.type);laplaciansmooth(1);transformVertices();return{verts:E,faces:a,}};